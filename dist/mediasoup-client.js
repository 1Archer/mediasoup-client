/*
 * mediasoup-client v2.0.1
 * mediasoup client side JavaScript SDK
 * https://mediasoup.org
 * Copyright © 2017, Iñaki Baz Castillo <ibc@aliax.net>
 * License: ISC
 */

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).mediasoupClient=e()}}(function(){return function e(t,r,n){function o(s,i){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!i&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return o(r||e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/promise")),a=n(e("babel-runtime/helpers/extends")),s=n(e("babel-runtime/core-js/object/get-prototype-of")),i=n(e("babel-runtime/helpers/classCallCheck")),c=n(e("babel-runtime/helpers/createClass")),u=n(e("babel-runtime/helpers/possibleConstructorReturn")),l=n(e("babel-runtime/helpers/inherits")),d=e("events"),f=n(e("./Logger")),p=e("./errors"),m=new f.default("CommandQueue"),h=function(e){function t(){(0,i.default)(this,t);var e=(0,u.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.setMaxListeners(1/0),e._closed=!1,e._busy=!1,e._queue=[],e}return(0,l.default)(t,e),(0,c.default)(t,[{key:"close",value:function(){this._closed=!0}},{key:"push",value:function(e,t){var r=this,n=(0,a.default)({method:e},t);return m.debug("push() [method:%s]",e),new o.default(function(e,t){var o=r._queue;n.resolve=e,n.reject=t,o.push(n),r._handlePendingCommands()})}},{key:"_handlePendingCommands",value:function(){var e=this;if(!this._busy){var t=this._queue,r=t[0];r&&(this._busy=!0,this._handleCommand(r).then(function(){e._busy=!1,t.shift(),e._handlePendingCommands()}))}}},{key:"_handleCommand",value:function(e){var t=this;if(m.debug("_handleCommand() [method:%s]",e.method),this._closed)return e.reject(new p.InvalidStateError("closed")),o.default.resolve();var r={promise:null};return this.emit("exec",e,r),o.default.resolve().then(function(){return r.promise}).then(function(r){m.debug("_handleCommand() | command succeeded [method:%s]",e.method),t._closed?e.reject(new p.InvalidStateError("closed")):e.resolve(r)}).catch(function(t){m.error("_handleCommand() | command failed [method:%s]: %o",e.method,t),e.reject(t)})}}]),t}(d.EventEmitter);r.default=h},{"./Logger":5,"./errors":10,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/extends":41,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,events:165}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/helpers/typeof")),a=n(e("babel-runtime/core-js/promise")),s=n(e("babel-runtime/core-js/object/get-prototype-of")),i=n(e("babel-runtime/helpers/classCallCheck")),c=n(e("babel-runtime/helpers/createClass")),u=n(e("babel-runtime/helpers/possibleConstructorReturn")),l=n(e("babel-runtime/helpers/inherits")),d=n(e("babel-runtime/core-js/set")),f=n(e("./Logger")),p=n(e("./EnhancedEventEmitter")),m=e("./errors"),h=new d.default(["default","low","medium","high"]),_=1,v=new f.default("Consumer"),b=function(e){function t(e,r,n,o,a){(0,i.default)(this,t);var c=(0,u.default)(this,(t.__proto__||(0,s.default)(t)).call(this,v));return c._id=e,c._closed=!1,c._kind=r,c._rtpParameters=n,c._peer=o,c._appData=a,c._supported=!1,c._transport=null,c._track=null,c._locallyPaused=!1,c._remotelyPaused=!1,c._statsEnabled=!1,c._statsInterval=_,c._preferredProfile="default",c._effectiveProfile=null,c}return(0,l.default)(t,e),(0,c.default)(t,[{key:"close",value:function(){v.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.transport&&this.transport.disableConsumerStats(this)),this.emit("@close"),this.safeEmit("close","local"),this._destroy())}},{key:"remoteClose",value:function(){v.debug("remoteClose()"),this._closed||(this._closed=!0,this._transport&&this._transport.removeConsumer(this),this._destroy(),this.emit("@close"),this.safeEmit("close","remote"))}},{key:"_destroy",value:function(){this._transport=null;try{this._track.stop()}catch(e){}this._track=null}},{key:"receive",value:function(e){var t=this;return v.debug("receive() [transport:%o]",e),this._closed?a.default.reject(new m.InvalidStateError("Consumer closed")):this._supported?this._transport?a.default.reject(new Error("already handled by a Transport")):"object"!==(void 0===e?"undefined":(0,o.default)(e))?a.default.reject(new TypeError("invalid Transport")):(this._transport=e,e.addConsumer(this).then(function(r){return t._track=r,t.paused&&(r.enabled=!1),e.once("@close",function(){if(!t._closed&&t._transport===e){t._transport=null;try{t._track.stop()}catch(e){}t._track=null,t.safeEmit("unhandled")}}),t.safeEmit("handled"),t._statsEnabled&&e.enableConsumerStats(t,t._statsInterval),r}).catch(function(e){throw t._transport=null,e})):a.default.reject(new Error("unsupported codecs"))}},{key:"pause",value:function(e){return v.debug("pause()"),this._closed?(v.error("pause() | Consumer closed"),!1):!!this._locallyPaused||(this._locallyPaused=!0,this._track&&(this._track.enabled=!1),this._transport&&this._transport.pauseConsumer(this,e),this.safeEmit("pause","local",e),this.paused)}},{key:"remotePause",value:function(e){v.debug("remotePause()"),this._closed||this._remotelyPaused||(this._remotelyPaused=!0,this._track&&(this._track.enabled=!1),this.safeEmit("pause","remote",e))}},{key:"resume",value:function(e){return v.debug("resume()"),this._closed?(v.error("resume() | Consumer closed"),!1):!this._locallyPaused||(this._locallyPaused=!1,this._track&&!this._remotelyPaused&&(this._track.enabled=!0),this._transport&&this._transport.resumeConsumer(this,e),this.safeEmit("resume","local",e),!this.paused)}},{key:"remoteResume",value:function(e){v.debug("remoteResume()"),!this._closed&&this._remotelyPaused&&(this._remotelyPaused=!1,this._track&&!this._locallyPaused&&(this._track.enabled=!0),this.safeEmit("resume","remote",e))}},{key:"setPreferredProfile",value:function(e){v.debug("setPreferredProfile() [profile:%s]",e),this._closed?v.error("setPreferredProfile() | Consumer closed"):e!==this._preferredProfile&&(h.has(e)?(this._preferredProfile=e,this._transport&&this._transport.setConsumerPreferredProfile(this,this._preferredProfile)):v.error('setPreferredProfile() | invalid profile "%s"',e))}},{key:"remoteSetPreferredProfile",value:function(e){v.debug("remoteSetPreferredProfile() [profile:%s]",e),this._closed||e===this._preferredProfile||(this._preferredProfile=e)}},{key:"remoteEffectiveProfileChanged",value:function(e){v.debug("remoteEffectiveProfileChanged() [profile:%s]",e),this._closed||e===this._effectiveProfile||(this._effectiveProfile=e,this.safeEmit("effectiveprofilechange",this._effectiveProfile))}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;v.debug("enableStats() [interval:%d]",e),this._closed?v.error("enableStats() | Consumer closed"):this._statsEnabled||("number"==typeof e?(this._statsInterval=e<1?_:e,this._statsEnabled=!0,this._transport&&this._transport.enableConsumerStats(this,this._statsInterval)):v.error("enableStats() | Invalid interval provided"))}},{key:"disableStats",value:function(){v.debug("disableStats()"),this._closed?v.error("disableStats() | Consumer closed"):this._statsEnabled&&(this._statsEnabled=!1,this._transport&&this._transport.disableConsumerStats(this))}},{key:"setSupported",value:function(e){this._supported=e}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"peer",get:function(){return this._peer}},{key:"appData",get:function(){return this._appData}},{key:"supported",get:function(){return this._supported}},{key:"transport",get:function(){return this._transport}},{key:"track",get:function(){return this._track}},{key:"locallyPaused",get:function(){return this._locallyPaused}},{key:"remotelyPaused",get:function(){return this._remotelyPaused}},{key:"paused",get:function(){return this._locallyPaused||this._remotelyPaused}},{key:"preferredProfile",get:function(){return this._preferredProfile}},{key:"effectiveProfile",get:function(){return this._effectiveProfile}}]),t}(p.default);r.default=b},{"./EnhancedEventEmitter":4,"./Logger":5,"./errors":10,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/core-js/set":36,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"babel-runtime/helpers/typeof":45}],3:[function(e,t,r){(function(t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/helpers/classCallCheck")),a=n(e("babel-runtime/helpers/createClass")),s=n(e("bowser")),i=n(e("./Logger")),c=n(e("./handlers/Chrome55")),u=n(e("./handlers/Safari11")),l=n(e("./handlers/Firefox50")),d=n(e("./handlers/Edge11")),f=new i.default("Device"),p=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"isSupported",value:function(){return e._detected||e._detect(),Boolean(e._handlerClass)}},{key:"_detect",value:function(){var r=t.navigator.userAgent,n=s.default._detect(r);e._detected=!0,e._flag=void 0,e._name=n.name||"unknown device",e._version=n.version||"unknown vesion",e._bowser=n,e._handlerClass=null,s.default.check({chrome:"55"},!0,r)?(e._flag="chrome",e._handlerClass=c.default):s.default.check({firefox:"50"},!0,r)?(e._flag="firefox",e._handlerClass=l.default):s.default.check({safari:"11"},!0,r)?(e._flag="safari",e._handlerClass=u.default):s.default.check({msedge:"11"},!0,r)&&(e._flag="msedge",e._handlerClass=d.default),s.default.check({opera:"44"},!0,r)&&(e._flag="opera",e._handlerClass=c.default),e.isSupported()?f.debug('device supported [flag:%s, name:"%s", version:%s, handler:%s]',e._flag,e._name,e._version,e._handlerClass.name):f.warn("device not supported [name:%s, version:%s]",e._name,e._version)}},{key:"flag",get:function(){return e._detected||e._detect(),e._flag}},{key:"name",get:function(){return e._detected||e._detect(),e._name}},{key:"version",get:function(){return e._detected||e._detect(),e._version}},{key:"bowser",get:function(){return e._detected||e._detect(),e._bowser}},{key:"Handler",get:function(){return e._detected||e._detect(),e._handlerClass}}]),e}();r.default=p,p._detected=!1,p._flag=void 0,p._name=void 0,p._version=void 0,p._bowser=void 0,p._handlerClass=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Logger":5,"./handlers/Chrome55":11,"./handlers/Edge11":12,"./handlers/Firefox50":13,"./handlers/Safari11":14,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,bowser:46}],4:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/promise")),a=n(e("babel-runtime/core-js/object/get-prototype-of")),s=n(e("babel-runtime/helpers/classCallCheck")),i=n(e("babel-runtime/helpers/createClass")),c=n(e("babel-runtime/helpers/possibleConstructorReturn")),u=n(e("babel-runtime/helpers/inherits")),l=e("events"),d=n(e("./Logger")),f=function(e){function t(e){(0,s.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return r.setMaxListeners(1/0),r._logger=e||new d.default("EnhancedEventEmitter"),r}return(0,u.default)(t,e),(0,i.default)(t,[{key:"safeEmit",value:function(e){try{for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.emit.apply(this,[e].concat(r))}catch(t){this._logger.error("safeEmit() | event listener threw an error [event:%s]:%o",e,t)}}},{key:"safeEmitAsPromise",value:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return new o.default(function(r,o){t.safeEmit.apply(t,[e].concat(n,[function(e){r(e)},function(r){t._logger.error("safeEmitAsPromise() | errback called [event:%s]:%o",e,r),o(r)}]))})}}]),t}(l.EventEmitter);r.default=f},{"./Logger":5,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,events:165}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/helpers/classCallCheck")),a=n(e("babel-runtime/helpers/createClass")),s=n(e("debug")),i="mediasoup-client",c=function(){function e(t){(0,o.default)(this,e),t?(this._debug=(0,s.default)(i+":"+t),this._warn=(0,s.default)(i+":WARN:"+t),this._error=(0,s.default)(i+":ERROR:"+t)):(this._debug=(0,s.default)(i),this._warn=(0,s.default)(i+":WARN"),this._error=(0,s.default)(i+":ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,a.default)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();r.default=c},{"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,debug:163}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/array/from")),a=n(e("babel-runtime/core-js/get-iterator")),s=n(e("babel-runtime/core-js/map")),i=n(e("babel-runtime/core-js/object/get-prototype-of")),c=n(e("babel-runtime/helpers/classCallCheck")),u=n(e("babel-runtime/helpers/createClass")),l=n(e("babel-runtime/helpers/possibleConstructorReturn")),d=n(e("babel-runtime/helpers/inherits")),f=n(e("./Logger")),p=n(e("./EnhancedEventEmitter")),m=new f.default("Peer"),h=function(e){function t(e,r){(0,c.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,m));return n._name=e,n._closed=!1,n._appData=r,n._consumers=new s.default,n}return(0,d.default)(t,e),(0,u.default)(t,[{key:"close",value:function(){if(m.debug("close()"),!this._closed){this._closed=!0,this.emit("@close"),this.safeEmit("close","local");var e=!0,t=!1,r=void 0;try{for(var n,o=(0,a.default)(this._consumers.values());!(e=(n=o.next()).done);e=!0)n.value.close()}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}}},{key:"remoteClose",value:function(e){if(m.debug("remoteClose()"),!this._closed){this._closed=!0,this.emit("@close"),this.safeEmit("close","remote",e);var t=!0,r=!1,n=void 0;try{for(var o,s=(0,a.default)(this._consumers.values());!(t=(o=s.next()).done);t=!0)o.value.remoteClose()}catch(e){r=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw n}}}}},{key:"getConsumerById",value:function(e){return this._consumers.get(e)}},{key:"addConsumer",value:function(e){var t=this;if(this._consumers.has(e.id))throw new Error("Consumer already exists [id:"+e.id+"]");this._consumers.set(e.id,e),e.on("@close",function(){t._consumers.delete(e.id)}),this.safeEmit("newconsumer",e)}},{key:"name",get:function(){return this._name}},{key:"closed",get:function(){return this._closed}},{key:"appData",get:function(){return this._appData}},{key:"consumers",get:function(){return(0,o.default)(this._consumers.values())}}]),t}(p.default);r.default=h},{"./EnhancedEventEmitter":4,"./Logger":5,"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/helpers/typeof")),a=n(e("babel-runtime/core-js/promise")),s=n(e("babel-runtime/helpers/extends")),i=n(e("babel-runtime/core-js/object/get-prototype-of")),c=n(e("babel-runtime/helpers/classCallCheck")),u=n(e("babel-runtime/helpers/createClass")),l=n(e("babel-runtime/helpers/possibleConstructorReturn")),d=n(e("babel-runtime/helpers/inherits")),f=n(e("./Logger")),p=n(e("./EnhancedEventEmitter")),m=e("./errors"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils")),_={low:1e5,medium:3e5,high:15e5},v=1,b=new f.default("Producer"),y=function(e){function t(e,r,n){(0,c.default)(this,t);var o=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,b));return o._id=h.randomNumber(),o._closed=!1,o._originalTrack=e,o._track=e.clone(),o._appData=n,o._simulcast=!1,r.simulcast&&(o._simulcast=(0,s.default)({},_,r.simulcast)),o._transport=null,o._rtpParameters=null,o._locallyPaused=!o._track.enabled,o._remotelyPaused=!1,o._statsEnabled=!1,o._statsInterval=v,o._handleTrack(),o}return(0,d.default)(t,e),(0,u.default)(t,[{key:"close",value:function(e){b.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.transport&&this.transport.disableProducerStats(this)),this._transport&&this._transport.removeProducer(this,"local",e),this._destroy(),this.emit("@close","local",e),this.safeEmit("close","local",e))}},{key:"remoteClose",value:function(e){b.debug("remoteClose()"),this._closed||(this._closed=!0,this._transport&&this._transport.removeProducer(this,"remote",e),this._destroy(),this.emit("@close","remote",e),this.safeEmit("close","remote",e))}},{key:"_destroy",value:function(){this._transport=!1,this._rtpParameters=null;try{this._track.stop()}catch(e){}}},{key:"send",value:function(e){var t=this;return b.debug("send() [transport:%o]",e),this._closed?a.default.reject(new m.InvalidStateError("Producer closed")):this._transport?a.default.reject(new Error("already handled by a Transport")):"object"!==(void 0===e?"undefined":(0,o.default)(e))?a.default.reject(new TypeError("invalid Transport")):(this._transport=e,e.addProducer(this).then(function(){e.once("@close",function(){t._closed||t._transport!==e||(t._transport.removeProducer(t,"local"),t._transport=null,t._rtpParameters=null,t.safeEmit("unhandled"))}),t.safeEmit("handled"),t._statsEnabled&&e.enableProducerStats(t,t._statsInterval)}).catch(function(e){throw t._transport=null,e}))}},{key:"pause",value:function(e){return b.debug("pause()"),this._closed?(b.error("pause() | Producer closed"),!1):!!this._locallyPaused||(this._locallyPaused=!0,this._track.enabled=!1,this._transport&&this._transport.pauseProducer(this,e),this.safeEmit("pause","local",e),this.paused)}},{key:"remotePause",value:function(e){b.debug("remotePause()"),this._closed||this._remotelyPaused||(this._remotelyPaused=!0,this._track.enabled=!1,this.safeEmit("pause","remote",e))}},{key:"resume",value:function(e){return b.debug("resume()"),this._closed?(b.error("resume() | Producer closed"),!1):!this._locallyPaused||(this._locallyPaused=!1,this._remotelyPaused||(this._track.enabled=!0),this._transport&&this._transport.resumeProducer(this,e),this.safeEmit("resume","local",e),!this.paused)}},{key:"remoteResume",value:function(e){b.debug("remoteResume()"),!this._closed&&this._remotelyPaused&&(this._remotelyPaused=!1,this._locallyPaused||(this._track.enabled=!0),this.safeEmit("resume","remote",e))}},{key:"replaceTrack",value:function(e){var t=this;if(b.debug("replaceTrack() [track:%o]",e),this._closed)return a.default.reject(new m.InvalidStateError("Producer closed"));if(!(e instanceof MediaStreamTrack))return a.default.reject(new TypeError("track is not a MediaStreamTrack"));if("ended"===e.readyState)return a.default.reject(new Error('track.readyState is "ended"'));var r=e.clone();return a.default.resolve().then(function(){if(t._transport)return t._transport.replaceProducerTrack(t,r)}).then(function(){try{t._track.onended=null,t._track.stop()}catch(e){}return t.paused?r.enabled=!1:r.enabled=!0,t._originalTrack=e,t._track=r,t._handleTrack(),t._track})}},{key:"setRtpParameters",value:function(e){this._rtpParameters=e}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;b.debug("enableStats() [interval:%d]",e),this._closed?b.error("enableStats() | Producer closed"):this._statsEnabled||("number"==typeof e?(this._statsInterval=e<1?v:e,this._statsEnabled=!0,this._transport&&this._transport.enableProducerStats(this,this._statsInterval)):b.error("enableStats() | Invalid interval provided"))}},{key:"disableStats",value:function(){b.debug("disableStats()"),this._closed?b.error("disableStats() | Producer closed"):this._statsEnabled&&(this._statsEnabled=!1,this._transport&&this._transport.disableProducerStats(this))}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"_handleTrack",value:function(){var e=this;this._track.onended=function(){e._closed||(b.warn('track "ended" event, closing Producer'),e.close())}}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"track",get:function(){return this._track}},{key:"originalTrack",get:function(){return this._originalTrack}},{key:"simulcast",get:function(){return this._simulcast}},{key:"appData",get:function(){return this._appData}},{key:"transport",get:function(){return this._transport}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"locallyPaused",get:function(){return this._locallyPaused}},{key:"remotelyPaused",get:function(){return this._remotelyPaused}},{key:"paused",get:function(){return this._locallyPaused||this._remotelyPaused}}]),t}(p.default);r.default=y},{"./EnhancedEventEmitter":4,"./Logger":5,"./errors":10,"./utils":23,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/extends":41,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"babel-runtime/helpers/typeof":45}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/array/from")),a=n(e("babel-runtime/helpers/extends")),s=n(e("babel-runtime/helpers/typeof")),i=n(e("babel-runtime/core-js/get-iterator")),c=n(e("babel-runtime/core-js/promise")),u=n(e("babel-runtime/core-js/map")),l=n(e("babel-runtime/core-js/object/get-prototype-of")),d=n(e("babel-runtime/helpers/classCallCheck")),f=n(e("babel-runtime/helpers/createClass")),p=n(e("babel-runtime/helpers/possibleConstructorReturn")),m=n(e("babel-runtime/helpers/inherits")),h=n(e("./Logger")),_=n(e("./EnhancedEventEmitter")),v=e("./errors"),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./ortc")),y=n(e("./Device")),g=n(e("./Transport")),k=n(e("./Producer")),w=n(e("./Peer")),P=n(e("./Consumer")),j=new h.default("Room"),C={new:"new",joining:"joining",joined:"joined",closed:"closed"},x=function(e){function t(e){(0,d.default)(this,t);var r=(0,p.default)(this,(t.__proto__||(0,l.default)(t)).call(this,j));if(j.debug("constructor() [options:%o]",e),!y.default.isSupported())throw new Error("current browser/device not supported");return e=e||{},r._settings={roomSettings:e.roomSettings,requestTimeout:e.requestTimeout||1e4,transportOptions:e.transportOptions||{},turnServers:e.turnServers||[]},r._state=C.new,r._peerName=null,r._transports=new u.default,r._producers=new u.default,r._peers=new u.default,r._extendedRtpCapabilities=null,r._canSendByKind={audio:!1,video:!1},r}return(0,m.default)(t,e),(0,f.default)(t,[{key:"getTransportById",value:function(e){return this._transports.get(e)}},{key:"getProducerById",value:function(e){return this._producers.get(e)}},{key:"getPeerByName",value:function(e){return this._peers.get(e)}},{key:"join",value:function(e,t){var r=this;if(j.debug('join() [peerName:"%s"]',e),"string"!=typeof e)return c.default.reject(new TypeError("invalid peerName"));if(this._state!==C.new&&this._state!==C.closed)return c.default.reject(new v.InvalidStateError('invalid state "'+this._state+'"'));this._peerName=e,this._state=C.joining;var n=void 0;return c.default.resolve().then(function(){return r._settings.roomSettings?void(n=r._settings.roomSettings):r._sendRequest("queryRoom",{target:"room"}).then(function(e){n=e,j.debug("join() | got Room settings:%o",n)})}).then(function(){return y.default.Handler.getNativeRtpCapabilities()}).then(function(e){j.debug("join() | native RTP capabilities:%o",e),r._extendedRtpCapabilities=b.getExtendedRtpCapabilities(e,n.rtpCapabilities),j.debug("join() | extended RTP capabilities:%o",r._extendedRtpCapabilities);var o=b.getUnsupportedCodecs(n.rtpCapabilities,n.mandatoryCodecPayloadTypes,r._extendedRtpCapabilities);if(o.length>0)throw j.error("%s mandatory room codecs not supported:%o",o.length,o),new v.UnsupportedError("mandatory room codecs not supported",o);r._canSendByKind.audio=b.canSend("audio",r._extendedRtpCapabilities),r._canSendByKind.video=b.canSend("video",r._extendedRtpCapabilities);var a=b.getRtpCapabilities(r._extendedRtpCapabilities);j.debug("join() | effective local RTP capabilities for receiving:%o",a);var s={target:"room",peerName:r._peerName,rtpCapabilities:a,appData:t};return r._sendRequest("join",s).then(function(e){return e.peers})}).then(function(e){var t=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(e||[]);!(t=(a=s.next()).done);t=!0){var c=a.value;try{r._handlePeerData(c)}catch(e){j.error("join() | error handling Peer:%o",e)}}}catch(e){n=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw o}}return r._state=C.joined,j.debug("join() | joined the Room"),r.peers}).catch(function(e){throw r._state=C.new,e})}},{key:"leave",value:function(e){if(j.debug("leave()"),!this.closed){this._sendNotification("leave",{appData:e}),this._state=C.closed,this.safeEmit("close","local",e);var t=!0,r=!1,n=void 0;try{for(var o,a=(0,i.default)(this._transports.values());!(t=(o=a.next()).done);t=!0)o.value.close()}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var s=!0,c=!1,u=void 0;try{for(var l,d=(0,i.default)(this._producers.values());!(s=(l=d.next()).done);s=!0)l.value.close()}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}var f=!0,p=!1,m=void 0;try{for(var h,_=(0,i.default)(this._peers.values());!(f=(h=_.next()).done);f=!0)h.value.close()}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}}}},{key:"remoteClose",value:function(e){if(j.debug("remoteClose()"),!this.closed){this._state=C.closed,this.safeEmit("close","remote",e);var t=!0,r=!1,n=void 0;try{for(var o,a=(0,i.default)(this._transports.values());!(t=(o=a.next()).done);t=!0)o.value.remoteClose()}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var s=!0,c=!1,u=void 0;try{for(var l,d=(0,i.default)(this._producers.values());!(s=(l=d.next()).done);s=!0)l.value.remoteClose()}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}var f=!0,p=!1,m=void 0;try{for(var h,_=(0,i.default)(this._peers.values());!(f=(h=_.next()).done);f=!0)h.value.remoteClose()}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}}}},{key:"canSend",value:function(e){if(!this.joined)throw new v.InvalidStateError('invalid state "'+this._state+'"');if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'+e+'"');return this._canSendByKind[e]}},{key:"createTransport",value:function(e,t){var r=this;if(j.debug("createTransport() [direction:%s]",e),!this.joined)throw new v.InvalidStateError('invalid state "'+this._state+'"');if("send"!==e&&"recv"!==e)throw new TypeError('invalid direction "'+e+'"');var n=new g.default(e,this._extendedRtpCapabilities,this._settings,t);return this._transports.set(n.id,n),n.on("@request",function(e,t,n,o){r._sendRequest(e,t).then(n).catch(o)}),n.on("@notify",function(e,t){r._sendNotification(e,t)}),n.on("@close",function(){r._transports.delete(n.id)}),n}},{key:"createProducer",value:function(e,t,r){var n=this;if(j.debug("createProducer() [track:%o, options:%o]",e,t),!this.joined)throw new v.InvalidStateError('invalid state "'+this._state+'"');if(!(e instanceof MediaStreamTrack))throw new TypeError("track is not a MediaStreamTrack");if(!this._canSendByKind[e.kind])throw new Error("cannot send "+e.kind);if("ended"===e.readyState)throw new Error('track.readyState is "ended"');t=t||{};var o=new k.default(e,t,r);return this._producers.set(o.id,o),o.on("@close",function(){n._producers.delete(o.id)}),o}},{key:"restartIce",value:function(){if(!this.joined)throw new v.InvalidStateError('invalid state "'+this._state+'"');var e=!0,t=!1,r=void 0;try{for(var n,o=(0,i.default)(this._transports.values());!(e=(n=o.next()).done);e=!0)n.value.restartIce()}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}},{key:"receiveNotification",value:function(e){var t=this;if(this.closed)return c.default.reject(new v.InvalidStateError("Room closed"));if("object"!==(void 0===e?"undefined":(0,s.default)(e)))return c.default.reject(new TypeError("wrong notification Object"));if(!0!==e.notification)return c.default.reject(new TypeError("not a notification"));if("string"!=typeof e.method)return c.default.reject(new TypeError("wrong/missing notification method"));var r=e.method;return j.debug("receiveNotification() [method:%s, notification:%o]",r,e),c.default.resolve().then(function(){switch(r){case"closed":var n=e.appData;t.remoteClose(n);break;case"transportClosed":var o=e.id,a=e.appData,s=t._transports.get(o);if(!s)throw new Error('Transport not found [id:"'+o+'"]');s.remoteClose(a);break;case"transportStats":var i=e.id,c=e.stats,u=t._transports.get(i);if(!u)throw new Error("transport not found [id:"+i+"]");u.remoteStats(c);break;case"newPeer":var l=e.name;if(t._peers.has(l))throw new Error('Peer already exists [name:"'+l+'"]');var d=e;t._handlePeerData(d);break;case"peerClosed":var f=e.name,p=e.appData,m=t._peers.get(f);if(!m)throw new Error('no Peer found [name:"'+f+'"]');m.remoteClose(p);break;case"producerPaused":var h=e.id,_=e.appData,v=t._producers.get(h);if(!v)throw new Error("Producer not found [id:"+h+"]");v.remotePause(_);break;case"producerResumed":var b=e.id,y=e.appData,g=t._producers.get(b);if(!g)throw new Error("Producer not found [id:"+b+"]");g.remoteResume(y);break;case"producerClosed":var k=e.id,w=e.appData,P=t._producers.get(k);if(!P)throw new Error("Producer not found [id:"+k+"]");P.remoteClose(w);break;case"producerStats":var j=e.id,C=e.stats,x=t._producers.get(j);if(!x)throw new Error("Producer not found [id:"+j+"]");x.remoteStats(C);break;case"newConsumer":var S=e.peerName,E=t._peers.get(S);if(!E)throw new Error('no Peer found [name:"'+S+'"]');var T=e;t._handleConsumerData(T,E);break;case"consumerClosed":var R=e.id,I=e.peerName,O=e.appData,F=t._peers.get(I);if(!F)throw new Error('no Peer found [name:"'+I+'"]');var D=F.getConsumerById(R);if(!D)throw new Error("Consumer not found [id:"+R+"]");D.remoteClose(O);break;case"consumerPaused":var M=e.id,L=e.peerName,A=e.appData,N=t._peers.get(L);if(!N)throw new Error('no Peer found [name:"'+L+'"]');var B=N.getConsumerById(M);if(!B)throw new Error("Consumer not found [id:"+M+"]");B.remotePause(A);break;case"consumerResumed":var U=e.id,G=e.peerName,z=e.appData,q=t._peers.get(G);if(!q)throw new Error('no Peer found [name:"'+G+'"]');var K=q.getConsumerById(U);if(!K)throw new Error("Consumer not found [id:"+U+"]");K.remoteResume(z);break;case"consumerPreferredProfileSet":var W=e.id,V=e.peerName,J=e.profile,Q=t._peers.get(V);if(!Q)throw new Error('no Peer found [name:"'+V+'"]');var $=Q.getConsumerById(W);if(!$)throw new Error("Consumer not found [id:"+W+"]");$.remoteSetPreferredProfile(J);break;case"consumerEffectiveProfileChanged":var H=e.id,X=e.peerName,Z=e.profile,Y=t._peers.get(X);if(!Y)throw new Error('no Peer found [name:"'+X+'"]');var ee=Y.getConsumerById(H);if(!ee)throw new Error("Consumer not found [id:"+H+"]");ee.remoteEffectiveProfileChanged(Z);break;case"consumerStats":var te=e.id,re=e.peerName,ne=e.stats,oe=t._peers.get(re);if(!oe)throw new Error('no Peer found [name:"'+re+'"]');var ae=oe.getConsumerById(te);if(!ae)throw new Error("Consumer not found [id:"+te+"]");ae.remoteStats(ne);break;default:throw new Error('unknown notification method "'+r+'"')}}).catch(function(t){j.error("receiveNotification() failed [notification:%o]: %s",e,t)})}},{key:"_sendRequest",value:function(e,t){var r=this,n=(0,a.default)({method:e,target:"peer"},t);return this.closed?(j.error("_sendRequest() | Room closed [method:%s, request:%o]",e,n),c.default.reject(new v.InvalidStateError("Room closed"))):(j.debug("_sendRequest() [method:%s, request:%o]",e,n),new c.default(function(t,o){var a=!1,s=setTimeout(function(){j.error("request failed [method:%s]: timeout",e),a=!0,o(new v.TimeoutError("timeout"))},r._settings.requestTimeout);r.safeEmit("request",n,function(n){if(!a){if(a=!0,clearTimeout(s),r.closed)return j.error("request failed [method:%s]: Room closed",e),void o(new Error("Room closed"));j.debug("request succeeded [method:%s, response:%o]",e,n),t(n)}},function(t){if(!a){if(a=!0,clearTimeout(s),r.closed)return j.error("request failed [method:%s]: Room closed",e),void o(new Error("Room closed"));t instanceof Error||(t=new Error(String(t))),j.error("request failed [method:%s]:%o",e,t),o(t)}})}))}},{key:"_sendNotification",value:function(e,t){if(!this.closed){var r=(0,a.default)({method:e,target:"peer",notification:!0},t);j.debug("_sendNotification() [method:%s, notification:%o]",e,r),this.safeEmit("notify",r)}}},{key:"_handlePeerData",value:function(e){var t=this,r=e.name,n=e.consumers,o=e.appData,a=new w.default(r,o);this._peers.set(a.name,a),a.on("@close",function(){t._peers.delete(a.name)});var s=!0,c=!1,u=void 0;try{for(var l,d=(0,i.default)(n);!(s=(l=d.next()).done);s=!0){var f=l.value;try{this._handleConsumerData(f,a)}catch(e){j.error("error handling existing Consumer in Peer:%o",e)}}}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}this.joined&&this.safeEmit("newpeer",a)}},{key:"_handleConsumerData",value:function(e,t){var r=e.id,n=e.kind,o=e.rtpParameters,a=e.paused,s=e.appData,i=new P.default(r,n,o,t,s);b.canReceive(i.rtpParameters,this._extendedRtpCapabilities)&&i.setSupported(!0),a&&i.remotePause(),t.addConsumer(i)}},{key:"joined",get:function(){return this._state===C.joined}},{key:"closed",get:function(){return this._state===C.closed}},{key:"peerName",get:function(){return this._peerName}},{key:"transports",get:function(){return(0,o.default)(this._transports.values())}},{key:"producers",get:function(){return(0,o.default)(this._producers.values())}},{key:"peers",get:function(){return(0,o.default)(this._peers.values())}}]),t}(_.default);r.default=x},{"./Consumer":2,"./Device":3,"./EnhancedEventEmitter":4,"./Logger":5,"./Peer":6,"./Producer":7,"./Transport":9,"./errors":10,"./ortc":22,"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/extends":41,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"babel-runtime/helpers/typeof":45}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/promise")),a=n(e("babel-runtime/core-js/object/get-prototype-of")),s=n(e("babel-runtime/helpers/classCallCheck")),i=n(e("babel-runtime/helpers/createClass")),c=n(e("babel-runtime/helpers/possibleConstructorReturn")),u=n(e("babel-runtime/helpers/inherits")),l=n(e("./Logger")),d=n(e("./EnhancedEventEmitter")),f=e("./errors"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils")),m=n(e("./Device")),h=n(e("./CommandQueue")),_=1,v=new l.default("Transport"),b=function(e){function t(e,r,n,o){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,v));return v.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",e,r),i._id=p.randomNumber(),i._closed=!1,i._direction=e,i._settings=n,i._appData=o,i._statsEnabled=!1,i._statsInterval=_,i._commandQueue=new h.default,i._handler=new m.default.Handler(e,r,n),i._connectionState="new",i._commandQueue.on("exec",i._execCommand.bind(i)),i._handleHandler(),i}return(0,u.default)(t,e),(0,i.default)(t,[{key:"close",value:function(e){v.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.disableStats()),this.safeEmit("@notify","closeTransport",{id:this._id,appData:e}),this.emit("@close"),this.safeEmit("close","local",e),this._destroy())}},{key:"remoteClose",value:function(e){v.debug("remoteClose()"),this._closed||(this._closed=!0,this.emit("@close"),this.safeEmit("close","remote",e),this._destroy())}},{key:"_destroy",value:function(){this._commandQueue.close(),this._handler.close()}},{key:"restartIce",value:function(){var e=this;v.debug("restartIce()"),this._closed||"new"!==this._connectionState&&o.default.resolve().then(function(){var t={id:e._id};return e.safeEmitAsPromise("@request","restartTransport",t)}).then(function(t){var r=t.iceParameters;return e._commandQueue.push("restartIce",{remoteIceParameters:r})}).catch(function(e){v.error("restartIce() | failed: %o",e)})}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;if(v.debug("enableStats() [interval:%d]",e),"number"==typeof e){this._statsInterval=e<1?_:e,this._statsEnabled=!0;var t={id:this._id,interval:this._statsInterval};this.safeEmit("@notify","enableTransportStats",t)}else v.error("enableStats() | Invalid interval provided")}},{key:"disableStats",value:function(){v.debug("disableStats()"),this._statsEnabled=!1;var e={id:this._id};this.safeEmit("@notify","disableTransportStats",e)}},{key:"_handleHandler",value:function(){var e=this,t=this._handler;t.on("@connectionstatechange",function(t){e._connectionState!==t&&(v.debug("Transport connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}),t.on("@needcreatetransport",function(t,r,n){var o={id:e._id,direction:e._direction,options:e._settings.transportOptions,appData:e._appData};t&&(o.dtlsParameters=t.dtlsParameters),e.safeEmit("@request","createTransport",o,r,n)}),t.on("@needupdatetransport",function(t){var r={id:e._id,dtlsParameters:t.dtlsParameters};e.safeEmit("@notify","updateTransport",r)}),t.on("@needupdateproducer",function(t,r){var n={id:t.id,rtpParameters:r};t.setRtpParameters(r),e.safeEmit("@notify","updateProducer",n)})}},{key:"addProducer",value:function(e){return v.debug("addProducer() [producer:%o]",e),this._closed?o.default.reject(new f.InvalidStateError("Transport closed")):"send"!==this._direction?o.default.reject(new Error("not a sending Transport")):this._commandQueue.push("addProducer",{producer:e})}},{key:"removeProducer",value:function(e,t,r){v.debug("removeProducer() [producer:%o]",e),this._closed||this._commandQueue.push("removeProducer",{producer:e}).catch(function(){}),"local"===t&&this.safeEmit("@notify","closeProducer",{id:e.id,appData:r})}},{key:"pauseProducer",value:function(e,t){v.debug("pauseProducer() [producer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","pauseProducer",r)}},{key:"resumeProducer",value:function(e,t){v.debug("resumeProducer() [producer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","resumeProducer",r)}},{key:"replaceProducerTrack",value:function(e,t){return v.debug("replaceProducerTrack() [producer:%o]",e),this._commandQueue.push("replaceProducerTrack",{producer:e,track:t})}},{key:"enableProducerStats",value:function(e,t){v.debug("enableProducerStats() [producer:%o]",e);var r={id:e.id,interval:t};this.safeEmit("@notify","enableProducerStats",r)}},{key:"disableProducerStats",value:function(e){v.debug("disableProducerStats() [producer:%o]",e);var t={id:e.id};this.safeEmit("@notify","disableProducerStats",t)}},{key:"addConsumer",value:function(e){return v.debug("addConsumer() [consumer:%o]",e),this._closed?o.default.reject(new f.InvalidStateError("Transport closed")):"recv"!==this._direction?o.default.reject(new Error("not a receiving Transport")):this._commandQueue.push("addConsumer",{consumer:e})}},{key:"removeConsumer",value:function(e){v.debug("removeConsumer() [consumer:%o]",e),this._commandQueue.push("removeConsumer",{consumer:e}).catch(function(){})}},{key:"pauseConsumer",value:function(e,t){v.debug("pauseConsumer() [consumer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","pauseConsumer",r)}},{key:"resumeConsumer",value:function(e,t){v.debug("resumeConsumer() [consumer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","resumeConsumer",r)}},{key:"setConsumerPreferredProfile",value:function(e,t){v.debug("setConsumerPreferredProfile() [consumer:%o]",e);var r={id:e.id,profile:t};this.safeEmit("@notify","setConsumerPreferredProfile",r)}},{key:"enableConsumerStats",value:function(e,t){v.debug("enableConsumerStats() [consumer:%o]",e);var r={id:e.id,interval:t};this.safeEmit("@notify","enableConsumerStats",r)}},{key:"disableConsumerStats",value:function(e){v.debug("disableConsumerStats() [consumer:%o]",e);var t={id:e.id};this.safeEmit("@notify","disableConsumerStats",t)}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"_execCommand",value:function(e,t){var r=void 0;try{switch(e.method){case"addProducer":var n=e.producer;r=this._execAddProducer(n);break;case"removeProducer":var a=e.producer;r=this._execRemoveProducer(a);break;case"replaceProducerTrack":var s=e.producer,i=e.track;r=this._execReplaceProducerTrack(s,i);break;case"addConsumer":var c=e.consumer;r=this._execAddConsumer(c);break;case"removeConsumer":var u=e.consumer;r=this._execRemoveConsumer(u);break;case"restartIce":var l=e.remoteIceParameters;r=this._execRestartIce(l);break;default:r=o.default.reject(new Error('unknown command method "'+e.method+'"'))}}catch(e){r=o.default.reject(e)}t.promise=r}},{key:"_execAddProducer",value:function(e){var t=this;v.debug("_execAddProducer()");var r=void 0;return o.default.resolve().then(function(){return t._handler.addProducer(e)}).then(function(n){r=n;var o={id:e.id,kind:e.kind,transportId:t._id,rtpParameters:n,paused:e.locallyPaused,appData:e.appData};return t.safeEmitAsPromise("@request","createProducer",o)}).then(function(){e.setRtpParameters(r)})}},{key:"_execRemoveProducer",value:function(e){return v.debug("_execRemoveProducer()"),this._handler.removeProducer(e)}},{key:"_execReplaceProducerTrack",value:function(e,t){return v.debug("_execReplaceProducerTrack()"),this._handler.replaceProducerTrack(e,t)}},{key:"_execAddConsumer",value:function(e){var t=this;v.debug("_execAddConsumer()");var r=void 0;return o.default.resolve().then(function(){return t._handler.addConsumer(e)}).then(function(n){r=n;var o={id:e.id,transportId:t.id,paused:e.locallyPaused,preferredProfile:e.preferredProfile};return t.safeEmitAsPromise("@request","enableConsumer",o)}).then(function(t){var n=t.paused,o=t.preferredProfile,a=t.effectiveProfile;return n&&e.remotePause(),o&&e.remoteSetPreferredProfile(o),a&&e.remoteEffectiveProfileChanged(a),r})}},{key:"_execRemoveConsumer",value:function(e){return v.debug("_execRemoveConsumer()"),this._handler.removeConsumer(e)}},{key:"_execRestartIce",value:function(e){return v.debug("_execRestartIce()"),this._handler.restartIce(e)}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"appData",get:function(){return this._appData}},{key:"connectionState",get:function(){return this._connectionState}}]),t}(d.default);r.default=b},{"./CommandQueue":1,"./Device":3,"./EnhancedEventEmitter":4,"./Logger":5,"./errors":10,"./utils":23,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.UnsupportedError=r.TimeoutError=r.InvalidStateError=void 0;var o=n(e("babel-runtime/core-js/object/get-prototype-of")),a=n(e("babel-runtime/helpers/classCallCheck")),s=n(e("babel-runtime/helpers/possibleConstructorReturn")),i=n(e("babel-runtime/helpers/inherits"));r.InvalidStateError=function(e){function t(e){(0,a.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return Object.defineProperty(r,"name",{enumerable:!1,writable:!1,value:"InvalidStateError"}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(r,t):Object.defineProperty(r,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),r}return(0,i.default)(t,e),t}(Error),r.TimeoutError=function(e){function t(e){(0,a.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return Object.defineProperty(r,"name",{enumerable:!1,writable:!1,value:"TimeoutError"}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(r,t):Object.defineProperty(r,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),r}return(0,i.default)(t,e),t}(Error),r.UnsupportedError=function(e){function t(e,r){(0,a.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return Object.defineProperty(n,"name",{enumerable:!1,writable:!1,value:"UnsupportedError"}),Object.defineProperty(n,"data",{enumerable:!0,writable:!1,value:r}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(n,t):Object.defineProperty(n,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),n}return(0,i.default)(t,e),t}(Error)},{"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43}],11:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("babel-runtime/core-js/array/from")),s=o(e("babel-runtime/core-js/map")),i=o(e("babel-runtime/core-js/set")),c=o(e("babel-runtime/core-js/promise")),u=o(e("babel-runtime/core-js/object/get-prototype-of")),l=o(e("babel-runtime/helpers/classCallCheck")),d=o(e("babel-runtime/helpers/createClass")),f=o(e("babel-runtime/helpers/possibleConstructorReturn")),p=o(e("babel-runtime/helpers/inherits")),m=o(e("sdp-transform")),h=o(e("../Logger")),_=o(e("../EnhancedEventEmitter")),v=n(e("../utils")),b=n(e("../ortc")),y=n(e("./sdp/commonUtils")),g=n(e("./sdp/planBUtils")),k=o(e("./sdp/RemotePlanBSdp")),w=new h.default("Chrome55"),P=function(e){function t(e,r,n){(0,l.default)(this,t);var o=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,w));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new k.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,p.default)(t,e),(0,d.default)(t,[{key:"close",value:function(){w.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(_.default),j=function(e){function t(e,r){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(w.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return c.default.reject("track already added");var n=void 0;return c.default.resolve().then(function(){return t._stream.addTrack(r),t._pc.addStream(t._stream),t._pc.createOffer()}).then(function(n){if(e.simulcast){w.debug("addProducer() | enabling simulcast");var o=m.default.parse(n.sdp);g.addSimulcastForTrack(o,r),n={type:"offer",sdp:m.default.write(o)}}return w.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",n),t._pc.setLocalDescription(n)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){n=m.default.parse(t._pc.localDescription.sdp);var e={type:"answer",sdp:t._remoteSdp.createAnswerSdp(n)};return w.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){var o=v.clone(t._rtpParametersByKind[e.kind]);return g.fillRtpParametersForTrack(o,n,r),o}).catch(function(e){throw t._stream.removeTrack(r),t._pc.addStream(t._stream),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return w.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),c.default.resolve().then(function(){return t._stream.removeTrack(r),t._pc.addStream(t._stream),t._pc.createOffer()}).then(function(e){return w.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).catch(function(e){if(0!==t._stream.getTracks().length)throw e;w.warn("removeProducer() | ignoring expected error due no sending tracks: %s",e.toString())}).then(function(){if("stable"!==t._pc.signalingState){var e=m.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return w.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;w.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track,o=void 0;return c.default.resolve().then(function(){return r._stream.removeTrack(n),r._stream.addTrack(t),r._pc.addStream(r._stream),r._pc.createOffer()}).then(function(n){if(e.simulcast){w.debug("addProducer() | enabling simulcast");var o=m.default.parse(n.sdp);g.addSimulcastForTrack(o,t),n={type:"offer",sdp:m.default.write(o)}}return w.debug("replaceProducerTrack() | calling pc.setLocalDescription() [offer:%o]",n),r._pc.setLocalDescription(n)}).then(function(){o=m.default.parse(r._pc.localDescription.sdp);var e={type:"answer",sdp:r._remoteSdp.createAnswerSdp(o)};return w.debug("replaceProducerTrack() | calling pc.setRemoteDescription() [answer:%o]",e),r._pc.setRemoteDescription(e)}).then(function(){var n=v.clone(r._rtpParametersByKind[e.kind]);g.fillRtpParametersForTrack(n,o,t),r.safeEmit("@needupdateproducer",e,n)}).catch(function(e){throw r._stream.removeTrack(t),r._stream.addTrack(n),r._pc.addStream(r._stream),e})}},{key:"restartIce",value:function(e){var t=this;return w.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),c.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return w.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=m.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return w.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)})}},{key:"_setupTransport",value:function(){var e=this;return w.debug("_setupTransport()"),c.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=m.default.parse(r),o=y.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(P),C=function(e){function t(e,r){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,"recv",e,r));return n._transportCreated=!1,n._transportUpdated=!1,n._kinds=new i.default,n._consumerInfos=new s.default,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(w.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return c.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={kind:e.kind,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),this._kinds.add(e.kind),c.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getRemoteStreams()[0].getTrackById(o.trackId);if(!e)throw new Error("remote track not found");return e})}},{key:"removeConsumer",value:function(e){var t=this;return w.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id)?(this._consumerInfos.delete(e.id),c.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):c.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return w.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),c.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return w.debug("_setupTransport()"),c.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){w.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=m.default.parse(e),r={dtlsParameters:y.extractDtlsParameters(t)};this.safeEmit("@needupdatetransport",r),this._transportUpdated=!0}}]),t}(P),x=function(){function e(t,r,n){(0,l.default)(this,e),w.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:b.getSendingRtpParameters("audio",r),video:b.getSendingRtpParameters("video",r)},new j(o,n);case"recv":return o={audio:b.getReceivingFullRtpParameters("audio",r),video:b.getReceivingFullRtpParameters("video",r)},new C(o,n)}}return(0,d.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){w.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});return e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(t){try{e.close()}catch(e){}var r=m.default.parse(t.sdp);return y.extractRtpCapabilities(r)}).catch(function(t){try{e.close()}catch(e){}throw t})}},{key:"name",get:function(){return"Chrome55"}}]),e}();r.default=x},{"../EnhancedEventEmitter":4,"../Logger":5,"../ortc":22,"../utils":23,"./sdp/RemotePlanBSdp":16,"./sdp/commonUtils":18,"./sdp/planBUtils":19,"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/core-js/set":36,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"sdp-transform":170}],12:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("babel-runtime/core-js/promise")),s=o(e("babel-runtime/core-js/get-iterator")),i=o(e("babel-runtime/core-js/map")),c=o(e("babel-runtime/core-js/object/get-prototype-of")),u=o(e("babel-runtime/helpers/classCallCheck")),l=o(e("babel-runtime/helpers/possibleConstructorReturn")),d=o(e("babel-runtime/helpers/createClass")),f=o(e("babel-runtime/helpers/inherits")),p=o(e("../Logger")),m=o(e("../EnhancedEventEmitter")),h=n(e("../utils")),_=n(e("../ortc")),v=n(e("./ortc/edgeUtils")),b="CNAME-EDGE-"+h.randomNumber(),y=new p.default("Edge11"),g=function(e){function t(e,r,n){(0,u.default)(this,t);var o=(0,l.default)(this,(t.__proto__||(0,c.default)(t)).call(this,y));return y.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",e,r),o._rtpParametersByKind={audio:_.getSendingRtpParameters("audio",r),video:_.getSendingRtpParameters("video",r)},o._transportReady=!1,o._iceGatherer=null,o._iceTransport=null,o._dtlsTransport=null,o._rtpSenders=new i.default,o._rtpReceivers=new i.default,o._transportRemoteParameters=null,o._setIceGatherer(n),o._setIceTransport(),o._setDtlsTransport(),o}return(0,f.default)(t,e),(0,d.default)(t,null,[{key:"getNativeRtpCapabilities",value:function(){return y.debug("getNativeRtpCapabilities()"),v.getCapabilities()}},{key:"name",get:function(){return"Edge11"}}]),(0,d.default)(t,[{key:"close",value:function(){y.debug("close()");try{this._iceGatherer.close()}catch(e){}try{this._iceTransport.stop()}catch(e){}try{this._dtlsTransport.stop()}catch(e){}var e=!0,t=!1,r=void 0;try{for(var n,o=(0,s.default)(this._rtpSenders.values());!(e=(n=o.next()).done);e=!0){var a=n.value;try{a.stop()}catch(e){}}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}var i=!0,c=!1,u=void 0;try{for(var l,d=(0,s.default)(this._rtpReceivers.values());!(i=(l=d.next()).done);i=!0){var f=l.value;try{f.stop()}catch(e){}}}catch(e){c=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(c)throw u}}}},{key:"addProducer",value:function(e){var t=this,r=e.track;return y.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._rtpSenders.has(e.id)?a.default.reject("Producer already added"):a.default.resolve().then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){y.debug("addProducer() | calling new RTCRtpSender()");var n=new RTCRtpSender(r,t._dtlsTransport),o=h.clone(t._rtpParametersByKind[e.kind]),a={ssrc:h.randomNumber()};o.codecs.some(function(e){return"rtx"===e.name})&&(a.rtx={ssrc:h.randomNumber()}),o.encodings.push(a),o.rtcp={cname:b,reducedSize:!0,mux:!0};var s=v.mangleRtpParameters(o);return y.debug("addProducer() | calling rtpSender.send() [params:%o]",s),n.send(s),t._rtpSenders.set(e.id,n),o})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return y.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),a.default.resolve().then(function(){var r=t._rtpSenders.get(e.id);if(!r)throw new Error("RTCRtpSender not found");t._rtpSenders.delete(e.id);try{y.debug("removeProducer() | calling rtpSender.stop()"),r.stop()}catch(e){y.warn("rtpSender.stop() failed:%o",e)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;return y.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id),a.default.resolve().then(function(){var n=r._rtpSenders.get(e.id);if(!n)throw new Error("RTCRtpSender not found");n.setTrack(t)})}},{key:"addConsumer",value:function(e){var t=this;return y.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._rtpReceivers.has(e.id)?a.default.reject("Consumer already added"):a.default.resolve().then(function(){y.debug("addProducer() | calling new RTCRtpReceiver()");var r=new RTCRtpReceiver(t._dtlsTransport,e.kind);r.addEventListener("error",function(e){y.error('iceGatherer "error" event [event:%o]',e)});var n=v.mangleRtpParameters(e.rtpParameters);y.debug("addProducer() | calling rtpReceiver.receive() [params:%o]",n),r.receive(n),t._rtpReceivers.set(e.id,r)})}},{key:"removeConsumer",value:function(e){var t=this;return y.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),a.default.resolve().then(function(){var r=t._rtpReceivers.get(e.id);if(!r)throw new Error("RTCRtpReceiver not found");t._rtpReceivers.delete(e.id);try{y.debug("removeConsumer() | calling rtpReceiver.stop()"),r.stop()}catch(e){y.warn("rtpReceiver.stop() failed:%o",e)}})}},{key:"restartIce",value:function(e){var t=this;y.debug("restartIce()"),a.default.resolve().then(function(){t._transportRemoteParameters.iceParameters=e;var r=t._transportRemoteParameters.iceCandidates;y.debug("restartIce() | calling iceTransport.start()"),t._iceTransport.start(t._iceGatherer,e,"controlling");var n=!0,o=!1,a=void 0;try{for(var i,c=(0,s.default)(r);!(n=(i=c.next()).done);n=!0){var u=i.value;t._iceTransport.addRemoteCandidate(u)}}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}t._iceTransport.addRemoteCandidate({})})}},{key:"_setIceGatherer",value:function(e){var t=new RTCIceGatherer({iceServers:e.turnServers||[],gatherPolicy:"all"});t.addEventListener("error",function(e){y.error('iceGatherer "error" event [event:%o]',e)});try{t.gather()}catch(e){y.debug("iceGatherer.gather() failed: %s",e.toString())}this._iceGatherer=t}},{key:"_setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}}),t.addEventListener("icestatechange",function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}}),t.addEventListener("candidatepairchange",function(e){y.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)}),this._iceTransport=t}},{key:"_setDtlsTransport",value:function(){var e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",function(){y.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",function(){y.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state)}),e.addEventListener("error",function(e){y.error('dtlsTransport "error" event [event:%o]',e)}),this._dtlsTransport=e}},{key:"_setupTransport",value:function(){var e=this;return y.debug("_setupTransport()"),a.default.resolve().then(function(){var t={},r=e._dtlsTransport.getLocalParameters();return r.role="server",t.dtlsParameters=r,e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._transportRemoteParameters=t;var r=t.iceParameters,n=t.iceCandidates,o=t.dtlsParameters;e._iceTransport.start(e._iceGatherer,r,"controlling");var a=!0,i=!1,c=void 0;try{for(var u,l=(0,s.default)(n);!(a=(u=l.next()).done);a=!0){var d=u.value;e._iceTransport.addRemoteCandidate(d)}}catch(e){i=!0,c=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw c}}e._iceTransport.addRemoteCandidate({}),o.fingerprints=o.fingerprints.filter(function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm}),e._dtlsTransport.start(o),e._transportReady=!0})}}]),t}(m.default);r.default=g},{"../EnhancedEventEmitter":4,"../Logger":5,"../ortc":22,"../utils":23,"./ortc/edgeUtils":15,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43}],13:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("babel-runtime/core-js/array/from")),s=o(e("babel-runtime/core-js/map")),i=o(e("babel-runtime/core-js/promise")),c=o(e("babel-runtime/core-js/object/get-prototype-of")),u=o(e("babel-runtime/helpers/classCallCheck")),l=o(e("babel-runtime/helpers/createClass")),d=o(e("babel-runtime/helpers/possibleConstructorReturn")),f=o(e("babel-runtime/helpers/inherits")),p=o(e("sdp-transform")),m=o(e("../Logger")),h=o(e("../EnhancedEventEmitter")),_=n(e("../utils")),v=n(e("../ortc")),b=n(e("./sdp/commonUtils")),y=n(e("./sdp/unifiedPlanUtils")),g=o(e("./sdp/RemoteUnifiedPlanSdp")),k=new m.default("Firefox50"),w=function(e){function t(e,r,n){(0,u.default)(this,t);var o=(0,d.default)(this,(t.__proto__||(0,c.default)(t)).call(this,k));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new g.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,f.default)(t,e),(0,l.default)(t,[{key:"close",value:function(){k.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(h.default),P=function(e){function t(e,r){(0,u.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,c.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n._nextRid=1,n}return(0,f.default)(t,e),(0,l.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(k.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return i.default.reject("track already added");var n=void 0,o=void 0;return i.default.resolve().then(function(){t._stream.addTrack(r),n=t._pc.addTrack(r,t._stream)}).then(function(){if(e.simulcast){k.debug("addProducer() | enabling simulcast");var r=[];return e.simulcast.high&&r.push({rid:"high"+t._nextRid,active:!0,priority:"high",maxBitrate:e.simulcast.high}),e.simulcast.medium&&r.push({rid:"medium"+t._nextRid,active:!0,priority:"medium",maxBitrate:e.simulcast.medium}),e.simulcast.low&&r.push({rid:"low"+t._nextRid,active:!0,priority:"low",maxBitrate:e.simulcast.low}),t._nextRid++,n.setParameters({encodings:r})}}).then(function(){return t._pc.createOffer()}).then(function(e){return k.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){o=p.default.parse(t._pc.localDescription.sdp);var e={type:"answer",sdp:t._remoteSdp.createAnswerSdp(o)};return k.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){var n=_.clone(t._rtpParametersByKind[e.kind]);return y.fillRtpParametersForTrack(n,o,r),n}).catch(function(e){try{t._pc.removeTrack(n)}catch(e){}throw t._stream.removeTrack(r),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return k.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),i.default.resolve().then(function(){var e=t._pc.getSenders().find(function(e){return e.track===r});if(!e)throw new Error("RTCRtpSender found");return t._pc.removeTrack(e),t._stream.removeTrack(r),i.default.resolve().then(function(){return t._pc.createOffer()}).then(function(e){return k.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)})}).then(function(){var e=p.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return k.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;k.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track;return i.default.resolve().then(function(){var e=r._pc.getSenders().find(function(e){return e.track===n});if(!e)throw new Error("local track not found");return e.replaceTrack(t)}).then(function(){r._stream.removeTrack(n),r._stream.addTrack(t)})}},{key:"restartIce",value:function(e){var t=this;return k.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),i.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=p.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)})}},{key:"_setupTransport",value:function(){var e=this;return k.debug("_setupTransport()"),i.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=p.default.parse(r),o=b.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(w),j=function(e){function t(e,r){(0,u.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,c.default)(t)).call(this,"recv",e,r));n._transportCreated=!1,n._transportUpdated=!1,n._consumerInfos=new s.default;var o={mid:"fake-datachannel-consumer",kind:"application",closed:!1,cname:null};return n._consumerInfos.set(555,o),n}return(0,f.default)(t,e),(0,l.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(k.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return i.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={mid:"consumer-"+e.kind+"-"+e.id,kind:e.kind,closed:e.closed,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),i.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._consumerInfos.values()))};return k.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return k.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getReceivers().find(function(e){var t=e.track;return!!t&&t.id===o.trackId});if(!e)throw new Error("remote track not found");return e.track})}},{key:"removeConsumer",value:function(e){var t=this;k.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind);var r=this._consumerInfos.get(e.id);return r?(r.closed=!0,i.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._consumerInfos.values()))};return k.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return k.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):i.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return k.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),i.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._consumerInfos.values()))};return k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return k.debug("_setupTransport()"),i.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){k.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=p.default.parse(e),r={dtlsParameters:b.extractDtlsParameters(t)};this.safeEmit("@needupdatetransport",r),this._transportUpdated=!0}}]),t}(w),C=function(){function e(t,r,n){(0,u.default)(this,e),k.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:v.getSendingRtpParameters("audio",r),video:v.getSendingRtpParameters("video",r)},new P(o,n);case"recv":return o={audio:v.getReceivingFullRtpParameters("audio",r),video:v.getReceivingFullRtpParameters("video",r)},new j(o,n)}}return(0,l.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){k.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");var r=t.captureStream(),n=r.getVideoTracks()[0];return e.addTrack(n,r).setParameters({encodings:[{rid:"RID1",maxBitrate:4e4},{rid:"RID2",maxBitrate:1e4}]}),e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(r){try{t.remove()}catch(e){}try{e.close()}catch(e){}var n=p.default.parse(r.sdp);return b.extractRtpCapabilities(n)}).catch(function(r){try{t.remove()}catch(e){}try{e.close()}catch(e){}throw r})}},{key:"name",get:function(){return"Firefox50"}}]),e}();r.default=C},{"../EnhancedEventEmitter":4,"../Logger":5,"../ortc":22,"../utils":23,"./sdp/RemoteUnifiedPlanSdp":17,"./sdp/commonUtils":18,"./sdp/unifiedPlanUtils":20,"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"sdp-transform":170}],14:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("babel-runtime/core-js/array/from")),s=o(e("babel-runtime/core-js/map")),i=o(e("babel-runtime/core-js/set")),c=o(e("babel-runtime/core-js/promise")),u=o(e("babel-runtime/core-js/object/get-prototype-of")),l=o(e("babel-runtime/helpers/classCallCheck")),d=o(e("babel-runtime/helpers/createClass")),f=o(e("babel-runtime/helpers/possibleConstructorReturn")),p=o(e("babel-runtime/helpers/inherits")),m=o(e("sdp-transform")),h=o(e("../Logger")),_=o(e("../EnhancedEventEmitter")),v=n(e("../utils")),b=n(e("../ortc")),y=n(e("./sdp/commonUtils")),g=n(e("./sdp/planBUtils")),k=o(e("./sdp/RemotePlanBSdp")),w=new h.default("Safari11"),P=function(e){function t(e,r,n){(0,l.default)(this,t);var o=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,w));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new k.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,p.default)(t,e),(0,d.default)(t,[{key:"close",value:function(){w.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(_.default),j=function(e){function t(e,r){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(w.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return c.default.reject("track already added");var n=void 0,o=void 0;return c.default.resolve().then(function(){return t._stream.addTrack(r),n=t._pc.addTrack(r,t._stream),t._pc.createOffer()}).then(function(e){return w.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){o=m.default.parse(t._pc.localDescription.sdp);var e={type:"answer",sdp:t._remoteSdp.createAnswerSdp(o)};return w.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){var n=v.clone(t._rtpParametersByKind[e.kind]);return g.fillRtpParametersForTrack(n,o,r),n}).catch(function(e){try{t._pc.removeTrack(n)}catch(e){}throw t._stream.removeTrack(r),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return w.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),c.default.resolve().then(function(){var e=t._pc.getSenders().find(function(e){return e.track===r});if(!e)throw new Error("RTCRtpSender found");return t._pc.removeTrack(e),t._stream.removeTrack(r),t._pc.createOffer()}).then(function(e){return w.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).catch(function(e){if(0!==t._stream.getTracks().length)throw e;w.warn("removeLocalTrack() | ignoring expected error due no sending tracks: %s",e.toString())}).then(function(){if("stable"!==t._pc.signalingState){var e=m.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return w.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;w.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track;return c.default.resolve().then(function(){var e=r._pc.getSenders().find(function(e){return e.track===n});if(!e)throw new Error("local track not found");return e.replaceTrack(t)}).then(function(){r._stream.removeTrack(n),r._stream.addTrack(t)})}},{key:"restartIce",value:function(e){var t=this;return w.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),c.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return w.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=m.default.parse(t._pc.localDescription.sdp),r={type:"answer",sdp:t._remoteSdp.createAnswerSdp(e)};return w.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)})}},{key:"_setupTransport",value:function(){var e=this;return w.debug("_setupTransport()"),c.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=m.default.parse(r),o=y.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(P),C=function(e){function t(e,r){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,"recv",e,r));return n._transportCreated=!1,n._transportUpdated=!1,n._kinds=new i.default,n._consumerInfos=new s.default,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(w.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return c.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={kind:e.kind,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),this._kinds.add(e.kind),c.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getReceivers().find(function(e){var t=e.track;return!!t&&t.id===o.trackId});if(!e)throw new Error("remote track not found");return e.track})}},{key:"removeConsumer",value:function(e){var t=this;return w.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id)?(this._consumerInfos.delete(e.id),c.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):c.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return w.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),c.default.resolve().then(function(){var e={type:"offer",sdp:t._remoteSdp.createOfferSdp((0,a.default)(t._kinds),(0,a.default)(t._consumerInfos.values()))};return w.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),t._pc.setRemoteDescription(e)}).then(function(){return t._pc.createAnswer()}).then(function(e){return w.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return w.debug("_setupTransport()"),c.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){w.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=m.default.parse(e),r={dtlsParameters:y.extractDtlsParameters(t)};this.safeEmit("@needupdatetransport",r),this._transportUpdated=!0}}]),t}(P),x=function(){function e(t,r,n){(0,l.default)(this,e),w.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:b.getSendingRtpParameters("audio",r),video:b.getSendingRtpParameters("video",r)},new j(o,n);case"recv":return o={audio:b.getReceivingFullRtpParameters("audio",r),video:b.getReceivingFullRtpParameters("video",r)},new C(o,n)}}return(0,d.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){w.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});return e.addTransceiver("audio"),e.addTransceiver("video"),e.createOffer().then(function(t){try{e.close()}catch(e){}var r=m.default.parse(t.sdp);return y.extractRtpCapabilities(r)}).catch(function(t){try{e.close()}catch(e){}throw t})}},{key:"name",get:function(){return"Safari11"}}]),e}();r.default=x},{"../EnhancedEventEmitter":4,"../Logger":5,"../ortc":22,"../utils":23,"./sdp/RemotePlanBSdp":16,"./sdp/commonUtils":18,"./sdp/planBUtils":19,"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/map":28,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/promise":35,"babel-runtime/core-js/set":36,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"sdp-transform":170}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(e("babel-runtime/core-js/get-iterator"));r.getCapabilities=function(){var e=RTCRtpReceiver.getCapabilities(),t=o.clone(e),r=!0,a=!1,s=void 0;try{for(var i,c=(0,n.default)(t.codecs);!(r=(i=c.next()).done);r=!0){var u=i.value;u.channels=u.numChannels,delete u.numChannels,"audio"!==u.kind?delete u.channels:u.channels||(u.channels=1),u.mimeType=u.kind+"/"+u.name,"rtx"===u.name&&(u.parameters.apt=Number(u.parameters.apt));var l=!0,d=!1,f=void 0;try{for(var p,m=(0,n.default)(u.rtcpFeedback||[]);!(l=(p=m.next()).done);l=!0){var h=p.value;h.parameter||delete h.parameter}}catch(e){d=!0,f=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw f}}}}catch(e){a=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw s}}return t},r.mangleRtpParameters=function(e){var t=o.clone(e),r=!0,a=!1,s=void 0;try{for(var i,c=(0,n.default)(t.codecs);!(r=(i=c.next()).done);r=!0){var u=i.value;u.channels&&(u.numChannels=u.channels,delete u.channels),delete u.mimeType}}catch(e){a=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw s}}return t};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../../utils"))},{"../../utils":23,"babel-runtime/core-js/get-iterator":25}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/object/keys")),a=n(e("babel-runtime/core-js/get-iterator")),s=n(e("babel-runtime/core-js/object/get-prototype-of")),i=n(e("babel-runtime/helpers/possibleConstructorReturn")),c=n(e("babel-runtime/helpers/inherits")),u=n(e("babel-runtime/helpers/classCallCheck")),l=n(e("babel-runtime/helpers/createClass")),d=n(e("sdp-transform")),f=n(e("../../Logger")),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../../utils")),m=new f.default("RemotePlanBSdp"),h=function(){function e(t){(0,u.default)(this,e),this._rtpParametersByKind=t,this._transportLocalParameters=null,this._transportRemoteParameters=null,this._sdpGlobalFields={id:p.randomNumber(),version:0}}return(0,l.default)(e,[{key:"setTransportLocalParameters",value:function(e){m.debug("setTransportLocalParameters() [transportLocalParameters:%o]",e),this._transportLocalParameters=e}},{key:"setTransportRemoteParameters",value:function(e){m.debug("setTransportRemoteParameters() [transportRemoteParameters:%o]",e),this._transportRemoteParameters=e}},{key:"updateTransportRemoteIceParameters",value:function(e){m.debug("updateTransportRemoteIceParameters() [remoteIceParameters:%o]",e),this._transportRemoteParameters.iceParameters=e}}]),e}(),_=function(e){function t(e){return(0,u.default)(this,t),(0,i.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,c.default)(t,e),(0,l.default)(t,[{key:"createAnswerSdp",value:function(e){if(m.debug("createAnswerSdp()"),!this._transportLocalParameters)throw new Error("no transport local parameters");if(!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,s={},i=(e.media||[]).map(function(e){return e.mid});this._sdpGlobalFields.version++,s.version=0,s.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},s.name="-",s.timing={start:0,stop:0},s.icelite=t.iceLite?"ice-lite":null,s.msidSemantic={semantic:"WMS",token:"*"},s.groups=[{type:"BUNDLE",mids:i.join(" ")}],s.media=[];var c=n.fingerprints.length;s.fingerprint={type:n.fingerprints[c-1].algorithm,hash:n.fingerprints[c-1].value};var u=!0,l=!1,f=void 0;try{for(var p,h=(0,a.default)(e.media||[]);!(u=(p=h.next()).done);u=!0){var _=p.value,v=_.type,b=this._rtpParametersByKind[v].codecs,y=this._rtpParametersByKind[v].headerExtensions,g={};g.type=_.type,g.port=7,g.protocol="RTP/SAVPF",g.connection={ip:"127.0.0.1",version:4},g.mid=_.mid,g.iceUfrag=t.usernameFragment,g.icePwd=t.password,g.candidates=[];var k=!0,w=!1,P=void 0;try{for(var j,C=(0,a.default)(r);!(k=(j=C.next()).done);k=!0){var x=j.value,S={};S.component=1,S.foundation=x.foundation,S.ip=x.ip,S.port=x.port,S.priority=x.priority,S.transport=x.protocol,S.type=x.type,x.tcpType&&(S.tcptype=x.tcpType),g.candidates.push(S)}}catch(e){w=!0,P=e}finally{try{!k&&C.return&&C.return()}finally{if(w)throw P}}switch(g.endOfCandidates="end-of-candidates",g.iceOptions="renomination",n.role){case"client":g.setup="active";break;case"server":g.setup="passive"}switch(_.direction){case"sendrecv":case"sendonly":g.direction="recvonly";break;case"recvonly":case"inactive":g.direction="inactive"}"video"===v&&(g.xGoogleFlag="conference"),g.rtp=[],g.rtcpFb=[],g.fmtp=[];var E=!0,T=!1,R=void 0;try{for(var I,O=(0,a.default)(b);!(E=(I=O.next()).done);E=!0){var F=I.value,D={payload:F.payloadType,codec:F.name,rate:F.clockRate};if(F.channels>1&&(D.encoding=F.channels),g.rtp.push(D),F.parameters){var M={payload:F.payloadType,config:""},L=!0,A=!1,N=void 0;try{for(var B,U=(0,a.default)((0,o.default)(F.parameters));!(L=(B=U.next()).done);L=!0){var G=B.value;M.config&&(M.config+=";"),M.config+=G+"="+F.parameters[G]}}catch(e){A=!0,N=e}finally{try{!L&&U.return&&U.return()}finally{if(A)throw N}}M.config&&g.fmtp.push(M)}if(F.rtcpFeedback){var z=!0,q=!1,K=void 0;try{for(var W,V=(0,a.default)(F.rtcpFeedback);!(z=(W=V.next()).done);z=!0){var J=W.value;g.rtcpFb.push({payload:F.payloadType,type:J.type,subtype:J.parameter||""})}}catch(e){q=!0,K=e}finally{try{!z&&V.return&&V.return()}finally{if(q)throw K}}}}}catch(e){T=!0,R=e}finally{try{!E&&O.return&&O.return()}finally{if(T)throw R}}g.payloads=b.map(function(e){return e.payloadType}).join(" "),g.ext=[];var Q=!0,$=!1,H=void 0;try{for(var X,Z=(0,a.default)(y);!(Q=(X=Z.next()).done);Q=!0){(function(){var e=X.value;if(!(_.ext||[]).find(function(t){return t.uri===e.uri}))return"continue";g.ext.push({uri:e.uri,value:e.id})})()}}catch(e){$=!0,H=e}finally{try{!Q&&Z.return&&Z.return()}finally{if($)throw H}}g.rtcpMux="rtcp-mux",g.rtcpRsize="rtcp-rsize",s.media.push(g)}}catch(e){l=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw f}}return d.default.write(s)}}]),t}(h),v=function(e){function t(e){(0,u.default)(this,t);var r=(0,i.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return r._streamId="recv-stream-"+p.randomNumber(),r}return(0,c.default)(t,e),(0,l.default)(t,[{key:"createOfferSdp",value:function(e,t){var r=this;if(m.debug("createOfferSdp()"),!this._transportRemoteParameters)throw new Error("no transport remote parameters");var n=this._transportRemoteParameters.iceParameters,s=this._transportRemoteParameters.iceCandidates,i=this._transportRemoteParameters.dtlsParameters,c={},u=e;this._sdpGlobalFields.version++,c.version=0,c.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},c.name="-",c.timing={start:0,stop:0},c.icelite=n.iceLite?"ice-lite":null,c.msidSemantic={semantic:"WMS",token:"*"},c.groups=[{type:"BUNDLE",mids:u.join(" ")}],c.media=[];var l=i.fingerprints.length;c.fingerprint={type:i.fingerprints[l-1].algorithm,hash:i.fingerprints[l-1].value};var f=!0,p=!1,h=void 0;try{for(var _,v=(0,a.default)(e);!(f=(_=v.next()).done);f=!0)!function(){var e=_.value,i=r._rtpParametersByKind[e].codecs,u=r._rtpParametersByKind[e].headerExtensions,l={};l.type=e,l.port=7,l.protocol="RTP/SAVPF",l.connection={ip:"127.0.0.1",version:4},l.mid=e,l.iceUfrag=n.usernameFragment,l.icePwd=n.password,l.candidates=[];var d=!0,f=!1,p=void 0;try{for(var m,h=(0,a.default)(s);!(d=(m=h.next()).done);d=!0){var v=m.value,b={};b.component=1,b.foundation=v.foundation,b.ip=v.ip,b.port=v.port,b.priority=v.priority,b.transport=v.protocol,b.type=v.type,v.tcpType&&(b.tcptype=v.tcpType),l.candidates.push(b)}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}l.endOfCandidates="end-of-candidates",l.iceOptions="renomination",l.setup="actpass",t.some(function(t){return t.kind===e})?l.direction="sendonly":l.direction="inactive",l.rtp=[],l.rtcpFb=[],l.fmtp=[];var y=!0,g=!1,k=void 0;try{for(var w,P=(0,a.default)(i);!(y=(w=P.next()).done);y=!0){var j=w.value,C={payload:j.payloadType,codec:j.name,rate:j.clockRate};if(j.channels>1&&(C.encoding=j.channels),l.rtp.push(C),j.parameters){var x={payload:j.payloadType,config:""},S=!0,E=!1,T=void 0;try{for(var R,I=(0,a.default)((0,o.default)(j.parameters));!(S=(R=I.next()).done);S=!0){var O=R.value;x.config&&(x.config+=";"),x.config+=O+"="+j.parameters[O]}}catch(e){E=!0,T=e}finally{try{!S&&I.return&&I.return()}finally{if(E)throw T}}x.config&&l.fmtp.push(x)}if(j.rtcpFeedback){var F=!0,D=!1,M=void 0;try{for(var L,A=(0,a.default)(j.rtcpFeedback);!(F=(L=A.next()).done);F=!0){var N=L.value;l.rtcpFb.push({payload:j.payloadType,type:N.type,subtype:N.parameter||""})}}catch(e){D=!0,M=e}finally{try{!F&&A.return&&A.return()}finally{if(D)throw M}}}}}catch(e){g=!0,k=e}finally{try{!y&&P.return&&P.return()}finally{if(g)throw k}}l.payloads=i.map(function(e){return e.payloadType}).join(" "),l.ext=[];var B=!0,U=!1,G=void 0;try{for(var z,q=(0,a.default)(u);!(B=(z=q.next()).done);B=!0){var K=z.value;l.ext.push({uri:K.uri,value:K.id})}}catch(e){U=!0,G=e}finally{try{!B&&q.return&&q.return()}finally{if(U)throw G}}l.rtcpMux="rtcp-mux",l.rtcpRsize="rtcp-rsize",l.ssrcs=[],l.ssrcGroups=[];var W=!0,V=!1,J=void 0;try{for(var Q,$=(0,a.default)(t);!(W=(Q=$.next()).done);W=!0){var H=Q.value;H.kind===e&&(l.ssrcs.push({id:H.ssrc,attribute:"msid",value:r._streamId+" "+H.trackId}),l.ssrcs.push({id:H.ssrc,attribute:"mslabel",value:r._streamId}),l.ssrcs.push({id:H.ssrc,attribute:"label",value:H.trackId}),l.ssrcs.push({id:H.ssrc,attribute:"cname",value:H.cname}),H.rtxSsrc&&(l.ssrcs.push({id:H.rtxSsrc,attribute:"msid",value:r._streamId+" "+H.trackId}),l.ssrcs.push({id:H.rtxSsrc,attribute:"mslabel",value:r._streamId}),l.ssrcs.push({id:H.rtxSsrc,attribute:"label",value:H.trackId}),l.ssrcs.push({id:H.rtxSsrc,attribute:"cname",value:H.cname}),l.ssrcGroups.push({semantics:"FID",ssrcs:H.ssrc+" "+H.rtxSsrc})))}}catch(e){V=!0,J=e}finally{try{!W&&$.return&&$.return()}finally{if(V)throw J}}c.media.push(l)}()}catch(e){p=!0,h=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw h}}return d.default.write(c)}}]),t}(h);r.default=function e(t,r){switch((0,u.default)(this,e),m.debug("constructor() [direction:%s, rtpParametersByKind:%o]",t,r),t){case"send":return new _(r);case"recv":return new v(r)}}},{"../../Logger":5,"../../utils":23,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/object/keys":33,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"sdp-transform":170}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/object/keys")),a=n(e("babel-runtime/core-js/get-iterator")),s=n(e("babel-runtime/core-js/object/get-prototype-of")),i=n(e("babel-runtime/helpers/possibleConstructorReturn")),c=n(e("babel-runtime/helpers/inherits")),u=n(e("babel-runtime/helpers/classCallCheck")),l=n(e("babel-runtime/helpers/createClass")),d=n(e("sdp-transform")),f=n(e("../../Logger")),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../../utils")),m=new f.default("RemoteUnifiedPlanSdp"),h=function(){function e(t){(0,u.default)(this,e),this._rtpParametersByKind=t,this._transportLocalParameters=null,this._transportRemoteParameters=null,this._sdpGlobalFields={id:p.randomNumber(),version:0}}return(0,l.default)(e,[{key:"setTransportLocalParameters",value:function(e){m.debug("setTransportLocalParameters() [transportLocalParameters:%o]",e),this._transportLocalParameters=e}},{key:"setTransportRemoteParameters",value:function(e){m.debug("setTransportRemoteParameters() [transportRemoteParameters:%o]",e),this._transportRemoteParameters=e}},{key:"updateTransportRemoteIceParameters",value:function(e){m.debug("updateTransportRemoteIceParameters() [remoteIceParameters:%o]",e),this._transportRemoteParameters.iceParameters=e}}]),e}(),_=function(e){function t(e){return(0,u.default)(this,t),(0,i.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,c.default)(t,e),(0,l.default)(t,[{key:"createAnswerSdp",value:function(e){if(m.debug("createAnswerSdp()"),!this._transportLocalParameters)throw new Error("no transport local parameters");if(!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,s={},i=(e.media||[]).filter(function(e){return e.mid}).map(function(e){return e.mid});this._sdpGlobalFields.version++,s.version=0,s.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},s.name="-",s.timing={start:0,stop:0},s.icelite=t.iceLite?"ice-lite":null,s.msidSemantic={semantic:"WMS",token:"*"},i.length>0&&(s.groups=[{type:"BUNDLE",mids:i.join(" ")}]),s.media=[];var c=n.fingerprints.length;s.fingerprint={type:n.fingerprints[c-1].algorithm,hash:n.fingerprints[c-1].value};var u=!0,l=!1,f=void 0;try{for(var p,h=(0,a.default)(e.media||[]);!(u=(p=h.next()).done);u=!0){var _=p.value,v="inactive"===_.direction,b=_.type,y=this._rtpParametersByKind[b].codecs,g=this._rtpParametersByKind[b].headerExtensions,k={};k.type=_.type,k.port=7,k.protocol="RTP/SAVPF",k.connection={ip:"127.0.0.1",version:4},k.mid=_.mid,k.iceUfrag=t.usernameFragment,k.icePwd=t.password,k.candidates=[];var w=!0,P=!1,j=void 0;try{for(var C,x=(0,a.default)(r);!(w=(C=x.next()).done);w=!0){var S=C.value,E={};E.component=1,E.foundation=S.foundation,E.ip=S.ip,E.port=S.port,E.priority=S.priority,E.transport=S.protocol,E.type=S.type,S.tcpType&&(E.tcptype=S.tcpType),k.candidates.push(E)}}catch(e){P=!0,j=e}finally{try{!w&&x.return&&x.return()}finally{if(P)throw j}}switch(k.endOfCandidates="end-of-candidates",k.iceOptions="renomination",n.role){case"client":k.setup="active";break;case"server":k.setup="passive"}switch(_.direction){case"sendrecv":case"sendonly":k.direction="recvonly";break;case"recvonly":case"inactive":k.direction="inactive"}k.rtp=[],k.rtcpFb=[],k.fmtp=[];var T=!0,R=!1,I=void 0;try{for(var O,F=(0,a.default)(y);!(T=(O=F.next()).done);T=!0){var D=O.value,M={payload:D.payloadType,codec:D.name,rate:D.clockRate};if(D.channels>1&&(M.encoding=D.channels),k.rtp.push(M),D.parameters){var L={payload:D.payloadType,config:""},A=!0,N=!1,B=void 0;try{for(var U,G=(0,a.default)((0,o.default)(D.parameters));!(A=(U=G.next()).done);A=!0){var z=U.value;L.config&&(L.config+=";"),L.config+=z+"="+D.parameters[z]}}catch(e){N=!0,B=e}finally{try{!A&&G.return&&G.return()}finally{if(N)throw B}}L.config&&k.fmtp.push(L)}if(D.rtcpFeedback){var q=!0,K=!1,W=void 0;try{for(var V,J=(0,a.default)(D.rtcpFeedback);!(q=(V=J.next()).done);q=!0){var Q=V.value;k.rtcpFb.push({payload:D.payloadType,type:Q.type,subtype:Q.parameter||""})}}catch(e){K=!0,W=e}finally{try{!q&&J.return&&J.return()}finally{if(K)throw W}}}}}catch(e){R=!0,I=e}finally{try{!T&&F.return&&F.return()}finally{if(R)throw I}}if(k.payloads=y.map(function(e){return e.payloadType}).join(" "),!v){k.ext=[];var $=!0,H=!1,X=void 0;try{for(var Z,Y=(0,a.default)(g);!($=(Z=Y.next()).done);$=!0){(function(){var e=Z.value;if(!(_.ext||[]).find(function(t){return t.uri===e.uri}))return"continue";k.ext.push({uri:e.uri,value:e.id})})()}}catch(e){H=!0,X=e}finally{try{!$&&Y.return&&Y.return()}finally{if(H)throw X}}}if(_.simulcast_03){k.simulcast_03={value:_.simulcast_03.value.replace(/send/g,"recv")},k.rids=[];var ee=!0,te=!1,re=void 0;try{for(var ne,oe=(0,a.default)(_.rids||[]);!(ee=(ne=oe.next()).done);ee=!0){var ae=ne.value;"send"===ae.direction&&k.rids.push({id:ae.id,direction:"recv"})}}catch(e){te=!0,re=e}finally{try{!ee&&oe.return&&oe.return()}finally{if(te)throw re}}}k.rtcpMux="rtcp-mux",k.rtcpRsize="rtcp-rsize",s.media.push(k)}}catch(e){l=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw f}}return d.default.write(s)}}]),t}(h),v=function(e){function t(e){(0,u.default)(this,t);var r=(0,i.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return r._streamId="recv-stream-"+p.randomNumber(),r}return(0,c.default)(t,e),(0,l.default)(t,[{key:"createOfferSdp",value:function(e){if(m.debug("createOfferSdp()"),!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,s={},i=e.filter(function(e){return!e.closed}).map(function(e){return e.mid});this._sdpGlobalFields.version++,s.version=0,s.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},s.name="-",s.timing={start:0,stop:0},s.icelite=t.iceLite?"ice-lite":null,s.msidSemantic={semantic:"WMS",token:"*"},i.length>0&&(s.groups=[{type:"BUNDLE",mids:i.join(" ")}]),s.media=[];var c=n.fingerprints.length;s.fingerprint={type:n.fingerprints[c-1].algorithm,hash:n.fingerprints[c-1].value};var u=!0,l=!1,f=void 0;try{for(var p,h=(0,a.default)(e);!(u=(p=h.next()).done);u=!0){var _=p.value,v=_.closed,b=_.kind,y=void 0,g=void 0;"application"!==_.kind&&(y=this._rtpParametersByKind[b].codecs,g=this._rtpParametersByKind[b].headerExtensions);var k={};"application"!==_.kind?(k.type=b,k.port=7,k.protocol="RTP/SAVPF",k.connection={ip:"127.0.0.1",version:4},k.mid=_.mid,k.msid=this._streamId+" "+_.trackId):(k.type=b,k.port=9,k.protocol="DTLS/SCTP",k.connection={ip:"127.0.0.1",version:4},k.mid=_.mid),k.iceUfrag=t.usernameFragment,k.icePwd=t.password,k.candidates=[];var w=!0,P=!1,j=void 0;try{for(var C,x=(0,a.default)(r);!(w=(C=x.next()).done);w=!0){var S=C.value,E={};E.component=1,E.foundation=S.foundation,E.ip=S.ip,E.port=S.port,E.priority=S.priority,E.transport=S.protocol,E.type=S.type,S.tcpType&&(E.tcptype=S.tcpType),k.candidates.push(E)}}catch(e){P=!0,j=e}finally{try{!w&&x.return&&x.return()}finally{if(P)throw j}}if(k.endOfCandidates="end-of-candidates",k.iceOptions="renomination",k.setup="actpass","application"!==_.kind){k.direction=v?"inactive":"sendonly",k.rtp=[],k.rtcpFb=[],k.fmtp=[];var T=!0,R=!1,I=void 0;try{for(var O,F=(0,a.default)(y);!(T=(O=F.next()).done);T=!0){var D=O.value,M={payload:D.payloadType,codec:D.name,rate:D.clockRate};if(D.channels>1&&(M.encoding=D.channels),k.rtp.push(M),D.parameters){var L={payload:D.payloadType,config:""},A=!0,N=!1,B=void 0;try{for(var U,G=(0,a.default)((0,o.default)(D.parameters));!(A=(U=G.next()).done);A=!0){var z=U.value;L.config&&(L.config+=";"),L.config+=z+"="+D.parameters[z]}}catch(e){N=!0,B=e}finally{try{!A&&G.return&&G.return()}finally{if(N)throw B}}L.config&&k.fmtp.push(L)}if(D.rtcpFeedback){var q=!0,K=!1,W=void 0;try{for(var V,J=(0,a.default)(D.rtcpFeedback);!(q=(V=J.next()).done);q=!0){var Q=V.value;k.rtcpFb.push({payload:D.payloadType,type:Q.type,subtype:Q.parameter||""})}}catch(e){K=!0,W=e}finally{try{!q&&J.return&&J.return()}finally{if(K)throw W}}}}}catch(e){R=!0,I=e}finally{try{!T&&F.return&&F.return()}finally{if(R)throw I}}if(k.payloads=y.map(function(e){return e.payloadType}).join(" "),!v){k.ext=[];var $=!0,H=!1,X=void 0;try{for(var Z,Y=(0,a.default)(g);!($=(Z=Y.next()).done);$=!0){var ee=Z.value;k.ext.push({uri:ee.uri,value:ee.id})}}catch(e){H=!0,X=e}finally{try{!$&&Y.return&&Y.return()}finally{if(H)throw X}}}k.rtcpMux="rtcp-mux",k.rtcpRsize="rtcp-rsize",v||(k.ssrcs=[],k.ssrcGroups=[],k.ssrcs.push({id:_.ssrc,attribute:"cname",value:_.cname}),_.rtxSsrc&&(k.ssrcs.push({id:_.rtxSsrc,attribute:"cname",value:_.cname}),k.ssrcGroups.push({semantics:"FID",ssrcs:_.ssrc+" "+_.rtxSsrc})))}else k.payloads=5e3,k.sctpmap={app:"webrtc-datachannel",maxMessageSize:256,sctpmapNumber:5e3};s.media.push(k)}}catch(e){l=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw f}}return d.default.write(s)}}]),t}(h);r.default=function e(t,r){switch((0,u.default)(this,e),m.debug("constructor() [direction:%s, rtpParametersByKind:%o]",t,r),t){case"send":return new _(r);case"recv":return new v(r)}}},{"../../Logger":5,"../../utils":23,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/object/get-prototype-of":32,"babel-runtime/core-js/object/keys":33,"babel-runtime/helpers/classCallCheck":39,"babel-runtime/helpers/createClass":40,"babel-runtime/helpers/inherits":42,"babel-runtime/helpers/possibleConstructorReturn":43,"sdp-transform":170}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return(e.media||[]).find(function(e){return e.iceUfrag&&0!==e.port})}Object.defineProperty(r,"__esModule",{value:!0});var a=n(e("babel-runtime/core-js/get-iterator")),s=n(e("babel-runtime/core-js/array/from")),i=n(e("babel-runtime/core-js/map"));r.extractRtpCapabilities=function(e){var t=new i.default,r=[],n=!1,o=!1,u=!0,l=!1,d=void 0;try{for(var f,p=(0,a.default)(e.media);!(u=(f=p.next()).done);u=!0){var m=f.value,h=m.type;switch(h){case"audio":if(n)continue;n=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var _=!0,v=!1,b=void 0;try{for(var y,g=(0,a.default)(m.rtp);!(_=(y=g.next()).done);_=!0){var k=y.value,w={name:k.codec,mimeType:h+"/"+k.codec,kind:h,clockRate:k.rate,preferredPayloadType:k.payload,channels:k.encoding,rtcpFeedback:[],parameters:{}};"audio"!==w.kind?delete w.channels:w.channels||(w.channels=1),t.set(w.preferredPayloadType,w)}}catch(e){v=!0,b=e}finally{try{!_&&g.return&&g.return()}finally{if(v)throw b}}var P=!0,j=!1,C=void 0;try{for(var x,S=(0,a.default)(m.fmtp||[]);!(P=(x=S.next()).done);P=!0){var E=x.value,T=c.default.parseFmtpConfig(E.config),R=t.get(E.payload);R&&(R.parameters=T)}}catch(e){j=!0,C=e}finally{try{!P&&S.return&&S.return()}finally{if(j)throw C}}var I=!0,O=!1,F=void 0;try{for(var D,M=(0,a.default)(m.rtcpFb||[]);!(I=(D=M.next()).done);I=!0){var L=D.value,A=t.get(L.payload);if(A){var N={type:L.type,parameter:L.subtype};N.parameter||delete N.parameter,A.rtcpFeedback.push(N)}}}catch(e){O=!0,F=e}finally{try{!I&&M.return&&M.return()}finally{if(O)throw F}}var B=!0,U=!1,G=void 0;try{for(var z,q=(0,a.default)(m.ext||[]);!(B=(z=q.next()).done);B=!0){var K=z.value,W={kind:h,uri:K.uri,preferredId:K.value};r.push(W)}}catch(e){U=!0,G=e}finally{try{!B&&q.return&&q.return()}finally{if(U)throw G}}}}catch(e){l=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(l)throw d}}return{codecs:(0,s.default)(t.values()),headerExtensions:r,fecMechanisms:[]}},r.extractDtlsParameters=function(e){var t=o(e),r=t.fingerprint||e.fingerprint,n=void 0;switch(t.setup){case"active":n="client";break;case"passive":n="server";break;case"actpass":n="auto"}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}};var c=n(e("sdp-transform"))},{"babel-runtime/core-js/array/from":24,"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/map":28,"sdp-transform":170}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/helpers/slicedToArray")),a=n(e("babel-runtime/core-js/get-iterator")),s=n(e("babel-runtime/core-js/map")),i=n(e("babel-runtime/core-js/set"));r.fillRtpParametersForTrack=function(e,t,r){var n=r.kind,c={cname:null,reducedSize:!0,mux:!0},u=(t.media||[]).find(function(e){return e.type===n});if(!u)throw new Error("m="+n+" section not found");var l=void 0,d=new i.default,f=!0,p=!1,m=void 0;try{for(var h,_=(0,a.default)(u.ssrcs||[]);!(f=(h=_.next()).done);f=!0){var v=h.value;if("msid"===v.attribute&&v.value.split(" ")[1]===r.id){var b=v.id;d.add(b),l||(l=b)}}}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}if(0===d.size)throw new Error("a=ssrc line not found for local track [track.id:"+r.id+"]");var y=new s.default,g=!0,k=!1,w=void 0;try{for(var P,j=(0,a.default)(u.ssrcGroups||[]);!(g=(P=j.next()).done);g=!0){var C=P.value;if("FID"===C.semantics){var x=C.ssrcs.split(/\s+/),S=(0,o.default)(x,2),E=S[0],T=S[1];E=Number(E),T=Number(T),d.has(E)&&(d.delete(E),d.delete(T),y.set(E,T))}}}catch(e){k=!0,w=e}finally{try{!g&&j.return&&j.return()}finally{if(k)throw w}}var R=!0,I=!1,O=void 0;try{for(var F,D=(0,a.default)(d);!(R=(F=D.next()).done);R=!0){var M=F.value;y.set(M,null)}}catch(e){I=!0,O=e}finally{try{!R&&D.return&&D.return()}finally{if(I)throw O}}var L=u.ssrcs.find(function(e){return"cname"===e.attribute&&e.id===l});L&&(c.cname=L.value),e.rtcp=c,e.encodings=[];var A=y.size>1,N=["low","medium","high"],B=!0,U=!1,G=void 0;try{for(var z,q=(0,a.default)(y);!(B=(z=q.next()).done);B=!0){var K=(0,o.default)(z.value,2),W={ssrc:K[0]};(T=K[1])&&(W.rtx={ssrc:T}),A&&(W.profile=N.shift()),e.encodings.push(W)}}catch(e){U=!0,G=e}finally{try{!B&&q.return&&q.return()}finally{if(U)throw G}}},r.addSimulcastForTrack=function(e,t){var r=t.kind,n=(e.media||[]).find(function(e){return e.type===r});if(!n)throw new Error("m="+r+" section not found");var o=void 0,a=void 0,s=void 0;if(!(n.ssrcs||[]).find(function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===t.id?(o=e.id,s=e.value.split(" ")[0],!0):void 0)}))throw new Error("a=ssrc line not found for local track [track.id:"+t.id+"]");(n.ssrcGroups||[]).some(function(e){if("FID"===e.semantics){var t=e.ssrcs.split(/\s+/);return Number(t[0])===o?(a=Number(t[1]),!0):void 0}});var i=n.ssrcs.find(function(e){return"cname"===e.attribute&&e.id===o});if(!i)throw new Error("CNAME line not found for local track [track.id:"+t.id+"]");var c=i.value,u=o+1,l=o+2;if(n.ssrcGroups=n.ssrcGroups||[],n.ssrcGroups.push({semantics:"SIM",ssrcs:o+" "+u+" "+l}),n.ssrcs.push({id:u,attribute:"cname",value:c}),n.ssrcs.push({id:u,attribute:"msid",value:s+" "+t.id}),n.ssrcs.push({id:l,attribute:"cname",value:c}),n.ssrcs.push({id:l,attribute:"msid",value:s+" "+t.id}),a){var d=a+1,f=a+2;n.ssrcGroups.push({semantics:"FID",ssrcs:u+" "+d}),n.ssrcs.push({id:d,attribute:"cname",value:c}),n.ssrcs.push({id:d,attribute:"msid",value:s+" "+t.id}),n.ssrcGroups.push({semantics:"FID",ssrcs:l+" "+f}),n.ssrcs.push({id:f,attribute:"cname",value:c}),n.ssrcs.push({id:f,attribute:"msid",value:s+" "+t.id})}}},{"babel-runtime/core-js/get-iterator":25,"babel-runtime/core-js/map":28,"babel-runtime/core-js/set":36,"babel-runtime/helpers/slicedToArray":44}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(e("babel-runtime/core-js/get-iterator"));r.fillRtpParametersForTrack=function(e,t,r){var o=r.kind,a={cname:null,reducedSize:!0,mux:!0},s=(t.media||[]).find(function(e){if(e.type===o){var t=e.msid;if(t)return t.split(" ")[1]===r.id||void 0}});if(!s)throw new Error("m="+o+" section not found");var i=(s.ssrcs||[]).find(function(e){return"cname"===e.attribute}),c=void 0;i&&(c=i.id,a.cname=i.value);var u=[],l=!0,d=!1,f=void 0;try{for(var p,m=(0,n.default)(s.rids||[]);!(l=(p=m.next()).done);l=!0){var h=p.value;"send"===h.direction&&(/^low/.test(h.id)?u.push({rid:h.id,profile:"low"}):/^medium/.test(h.id)&&u.push({rid:h.id,profile:"medium"}),/^high/.test(h.id)&&u.push({rid:h.id,profile:"high"}))}}catch(e){d=!0,f=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw f}}if(e.rtcp=a,e.encodings=[],0===u.length){var _={ssrc:c};e.encodings.push(_)}else{var v=!0,b=!1,y=void 0;try{for(var g,k=(0,n.default)(u);!(v=(g=k.next()).done);v=!0){var w=g.value,P={encodingId:w.rid,profile:w.profile};e.encodings.push(P)}}catch(e){b=!0,y=e}finally{try{!v&&k.return&&k.return()}finally{if(b)throw y}}}}},{"babel-runtime/core-js/get-iterator":25}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.Room=void 0,r.isDeviceSupported=function(){return o.default.isSupported()},r.getDeviceInfo=function(){return{flag:o.default.flag,name:o.default.name,version:o.default.version,bowser:o.default.bowser}};var o=n(e("./Device")),a=n(e("./Room"));r.Room=a.default},{"./Device":3,"./Room":8}],22:[function(e,t,r){"use strict";function n(e,t){var r=e.mimeType.toLowerCase();return r===t.mimeType.toLowerCase()&&(e.clockRate===t.clockRate&&(e.channels===t.channels&&("video/h264"!==r||((e.parameters||{})["packetization-mode"]||0)===((t.parameters||{})["packetization-mode"]||0))))}function o(e,t){return(!e.kind||!t.kind||e.kind===t.kind)&&e.uri===t.uri}function a(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=(0,s.default)(e.rtcpFeedback||[]);!(n=(i=c.next()).done);n=!0)!function(){var e=i.value,n=(t.rtcpFeedback||[]).find(function(t){return t.type===e.type&&t.parameter===e.parameter});n&&r.push(n)}()}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}return r}Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){return e&&e.__esModule?e:{default:e}}(e("babel-runtime/core-js/get-iterator"));r.getExtendedRtpCapabilities=function(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=!0,c=!1,u=void 0;try{for(var l,d=(0,s.default)(t.codecs||[]);!(i=(l=d.next()).done);i=!0)!function(){var t=l.value;if("rtx"===t.name)return"continue";var o=(e.codecs||[]).find(function(e){return n(e,t)});if(o){var s={name:t.name,mimeType:t.mimeType,kind:t.kind,clockRate:t.clockRate,sendPayloadType:o.preferredPayloadType,sendRtxPayloadType:null,recvPayloadType:t.preferredPayloadType,recvRtxPayloadType:null,channels:t.channels,rtcpFeedback:a(o,t),parameters:t.parameters};s.channels||delete s.channels,r.codecs.push(s)}}()}catch(e){c=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(c)throw u}}var f=!0,p=!1,m=void 0;try{for(var h,_=(0,s.default)(r.codecs||[]);!(f=(h=_.next()).done);f=!0)!function(){var r=h.value,n=(e.codecs||[]).find(function(e){return"rtx"===e.name&&e.parameters.apt===r.sendPayloadType}),o=(t.codecs||[]).find(function(e){return"rtx"===e.name&&e.parameters.apt===r.recvPayloadType});n&&o&&(r.sendRtxPayloadType=n.preferredPayloadType,r.recvRtxPayloadType=o.preferredPayloadType)}()}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}var v=!0,b=!1,y=void 0;try{for(var g,k=(0,s.default)(t.headerExtensions||[]);!(v=(g=k.next()).done);v=!0)!function(){var t=g.value,n=(e.headerExtensions||[]).find(function(e){return o(e,t)});if(n){var a={kind:t.kind,uri:t.uri,sendId:n.preferredId,recvId:t.preferredId};r.headerExtensions.push(a)}}()}catch(e){b=!0,y=e}finally{try{!v&&k.return&&k.return()}finally{if(b)throw y}}return r},r.getRtpCapabilities=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},r=!0,n=!1,o=void 0;try{for(var a,i=(0,s.default)(e.codecs);!(r=(a=i.next()).done);r=!0){var c=a.value,u={name:c.name,mimeType:c.mimeType,kind:c.kind,clockRate:c.clockRate,preferredPayloadType:c.recvPayloadType,channels:c.channels,rtcpFeedback:c.rtcpFeedback,parameters:c.parameters};if(u.channels||delete u.channels,t.codecs.push(u),c.recvRtxPayloadType){var l={name:"rtx",mimeType:c.kind+"/rtx",kind:c.kind,clockRate:c.clockRate,preferredPayloadType:c.recvRtxPayloadType,parameters:{apt:c.recvPayloadType}};t.codecs.push(l)}}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}var d=!0,f=!1,p=void 0;try{for(var m,h=(0,s.default)(e.headerExtensions);!(d=(m=h.next()).done);d=!0){var _=m.value,v={kind:_.kind,uri:_.uri,preferredId:_.recvId};t.headerExtensions.push(v)}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}return t.fecMechanisms=e.fecMechanisms,t},r.getUnsupportedCodecs=function(e,t,r){if(!Array.isArray(t))return[];var n=[],o=e.codecs,a=r.codecs,i=!0,c=!1,u=void 0;try{for(var l,d=(0,s.default)(t);!(i=(l=d.next()).done);i=!0)!function(){var e=l.value;if(!a.some(function(t){return t.recvPayloadType===e})){var t=o.find(function(t){return t.preferredPayloadType===e});if(!t)throw new Error("mandatory codec PT "+e+" not found in remote codecs");n.push(t)}}()}catch(e){c=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(c)throw u}}return n},r.canSend=function(e,t){return t.codecs.some(function(t){return t.kind===e})},r.canReceive=function(e,t){if(0===e.codecs.length)return!1;var r=e.codecs[0];return t.codecs.some(function(e){return e.recvPayloadType===r.payloadType})},r.getSendingRtpParameters=function(e,t){var r={muxId:null,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},n=!0,o=!1,a=void 0;try{for(var i,c=(0,s.default)(t.codecs);!(n=(i=c.next()).done);n=!0){var u=i.value;if(u.kind===e){var l={name:u.name,mimeType:u.mimeType,clockRate:u.clockRate,payloadType:u.sendPayloadType,channels:u.channels,rtcpFeedback:u.rtcpFeedback,parameters:u.parameters};if(l.channels||delete l.channels,r.codecs.push(l),u.sendRtxPayloadType){var d={name:"rtx",mimeType:u.kind+"/rtx",clockRate:u.clockRate,payloadType:u.sendRtxPayloadType,parameters:{apt:u.sendPayloadType}};r.codecs.push(d)}break}}}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}var f=!0,p=!1,m=void 0;try{for(var h,_=(0,s.default)(t.headerExtensions);!(f=(h=_.next()).done);f=!0){var v=h.value;if(!v.kind||v.kind===e){var b={uri:v.uri,id:v.sendId};r.headerExtensions.push(b)}}}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}return r},r.getReceivingFullRtpParameters=function(e,t){var r={muxId:null,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},n=!0,o=!1,a=void 0;try{for(var i,c=(0,s.default)(t.codecs);!(n=(i=c.next()).done);n=!0){var u=i.value;if(u.kind===e){var l={name:u.name,mimeType:u.mimeType,clockRate:u.clockRate,payloadType:u.recvPayloadType,channels:u.channels,rtcpFeedback:u.rtcpFeedback,parameters:u.parameters};if(l.channels||delete l.channels,r.codecs.push(l),u.recvRtxPayloadType){var d={name:"rtx",mimeType:u.kind+"/rtx",clockRate:u.clockRate,payloadType:u.recvRtxPayloadType,parameters:{apt:u.recvPayloadType}};r.codecs.push(d)}}}}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}var f=!0,p=!1,m=void 0;try{for(var h,_=(0,s.default)(t.headerExtensions);!(f=(h=_.next()).done);f=!0){var v=h.value;if(!v.kind||v.kind===e){var b={uri:v.uri,id:v.recvId};r.headerExtensions.push(b)}}}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}return r}},{"babel-runtime/core-js/get-iterator":25}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("babel-runtime/core-js/json/stringify"));r.randomNumber=function(){return a()},r.clone=function(e){return JSON.parse((0,o.default)(e))};var a=n(e("random-number")).default.generator({min:1e7,max:99999999,integer:!0})},{"babel-runtime/core-js/json/stringify":27,"random-number":168}],24:[function(e,t,r){t.exports={default:e("core-js/library/fn/array/from"),__esModule:!0}},{"core-js/library/fn/array/from":47}],25:[function(e,t,r){t.exports={default:e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":48}],26:[function(e,t,r){t.exports={default:e("core-js/library/fn/is-iterable"),__esModule:!0}},{"core-js/library/fn/is-iterable":49}],27:[function(e,t,r){t.exports={default:e("core-js/library/fn/json/stringify"),__esModule:!0}},{"core-js/library/fn/json/stringify":50}],28:[function(e,t,r){t.exports={default:e("core-js/library/fn/map"),__esModule:!0}},{"core-js/library/fn/map":51}],29:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":52}],30:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":53}],31:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":54}],32:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/get-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/get-prototype-of":55}],33:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":56}],34:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":57}],35:[function(e,t,r){t.exports={default:e("core-js/library/fn/promise"),__esModule:!0}},{"core-js/library/fn/promise":58}],36:[function(e,t,r){t.exports={default:e("core-js/library/fn/set"),__esModule:!0}},{"core-js/library/fn/set":59}],37:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":60}],38:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":61}],39:[function(e,t,r){"use strict";r.__esModule=!0,r.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],40:[function(e,t,r){"use strict";r.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../core-js/object/define-property"));r.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},{"../core-js/object/define-property":31}],41:[function(e,t,r){"use strict";r.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../core-js/object/assign"));r.default=n.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}},{"../core-js/object/assign":29}],42:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var o=n(e("../core-js/object/set-prototype-of")),a=n(e("../core-js/object/create")),s=n(e("../helpers/typeof"));r.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,a.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}},{"../core-js/object/create":30,"../core-js/object/set-prototype-of":34,"../helpers/typeof":45}],43:[function(e,t,r){"use strict";r.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../helpers/typeof"));r.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}},{"../helpers/typeof":45}],44:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var o=n(e("../core-js/is-iterable")),a=n(e("../core-js/get-iterator"));r.default=function(){function e(e,t){var r=[],n=!0,o=!1,s=void 0;try{for(var i,c=(0,a.default)(e);!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}return r}return function(t,r){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},{"../core-js/get-iterator":25,"../core-js/is-iterable":26}],45:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var o=n(e("../core-js/symbol/iterator")),a=n(e("../core-js/symbol")),s="function"==typeof a.default&&"symbol"==typeof o.default?function(e){return typeof e}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};r.default="function"==typeof a.default&&"symbol"===s(o.default)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":void 0===e?"undefined":s(e)}},{"../core-js/symbol":37,"../core-js/symbol/iterator":38}],46:[function(e,t,r){!function(e,r,n){void 0!==t&&t.exports?t.exports=n():e.bowser=n()}(this,0,function(){function e(e){function t(t){var r=e.match(t);return r&&r.length>1&&r[1]||""}function r(t){var r=e.match(t);return r&&r.length>1&&r[2]||""}var n,o=t(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(e)&&/android/i.test(e),i=/nexus\s*[0-6]\s*/i.test(e),c=!i&&/nexus\s*[0-9]+/i.test(e),u=/CrOS/.test(e),l=/silk/i.test(e),d=/sailfish/i.test(e),f=/tizen/i.test(e),p=/(web|hpw)os/i.test(e),m=/windows phone/i.test(e),h=(/SamsungBrowser/i.test(e),!m&&/windows/i.test(e)),_=!o&&!l&&/macintosh/i.test(e),v=!s&&!d&&!f&&!p&&/linux/i.test(e),b=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),y=t(/version\/(\d+(\.\d+)?)/i),g=/tablet/i.test(e)&&!/tablet pc/i.test(e),k=!g&&/[^-]mobi/i.test(e),w=/xbox/i.test(e);/opera/i.test(e)?n={name:"Opera",opera:a,version:y||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?n={name:"Opera",opera:a,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||y}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:a,version:y||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:a,version:y||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:a,version:y||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:a,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:a,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:a,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:a,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:a,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:a,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:m?(n={name:"Windows Phone",osname:"Windows Phone",windowsphone:a},b?(n.msedge=a,n.version=b):(n.msie=a,n.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:a,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:u?n={name:"Chrome",osname:"Chrome OS",chromeos:a,chromeBook:a,chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?n={name:"Microsoft Edge",msedge:a,version:b}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:a,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||y}:d?n={name:"Sailfish",osname:"Sailfish OS",sailfish:a,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:a,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:a,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=a,n.osname="Firefox OS")):l?n={name:"Amazon Silk",silk:a,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:a,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:a,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",osname:"BlackBerry OS",blackberry:a,version:y||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:p?(n={name:"WebOS",osname:"WebOS",webos:a,version:y||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=a)):/bada/i.test(e)?n={name:"Bada",osname:"Bada",bada:a,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:f?n={name:"Tizen",osname:"Tizen",tizen:a,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||y}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:a,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||y}:/chromium/i.test(e)?n={name:"Chromium",chromium:a,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||y}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?n={name:"Android",version:y}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:a},y&&(n.version=y)):o?(n={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},y&&(n.version=y)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:a,version:t(/googlebot\/(\d+(\.\d+))/i)||y}:{name:t(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=a):(n.name=n.name||"Webkit",n.webkit=a),!n.version&&y&&(n.version=y)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=a,n.version=n.version||t(/gecko\/(\d+(\.\d+)?)/i)),n.windowsphone||!s&&!n.silk?!n.windowsphone&&o?(n[o]=a,n.ios=a,n.osname="iOS"):_?(n.mac=a,n.osname="macOS"):w?(n.xbox=a,n.osname="Xbox"):h?(n.windows=a,n.osname="Windows"):v&&(n.linux=a,n.osname="Linux"):(n.android=a,n.osname="Android");var P="";n.windows?P=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(t(/Windows ((NT|XP)( \d\d?.\d)?)/i)):n.windowsphone?P=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n.mac?P=(P=t(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):o?P=(P=t(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?P=t(/android[ \/-](\d+(\.\d+)*)/i):n.webos?P=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?P=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?P=t(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(P=t(/tizen[\/\s](\d+(\.\d+)*)/i)),P&&(n.osversion=P);var j=!n.windows&&P.split(".")[0];return g||c||"ipad"==o||s&&(3==j||j>=4&&!k)||n.silk?n.tablet=a:(k||"iphone"==o||"ipod"==o||s||i||n.blackberry||n.webos||n.bada)&&(n.mobile=a),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=a:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=a:n.x=a,n}function t(e){return e.split(".").length}function r(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function n(e){for(var n=Math.max(t(e[0]),t(e[1])),o=r(e,function(e){var o=n-t(e);return e+=new Array(o+1).join(".0"),r(e.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--n>=0;){if(o[0][n]>o[1][n])return 1;if(o[0][n]!==o[1][n])return-1;if(0===n)return 0}}function o(t,r,o){var a=s;"string"==typeof r&&(o=r,r=void 0),void 0===r&&(r=!1),o&&(a=e(o));var i=""+a.version;for(var c in t)if(t.hasOwnProperty(c)&&a[c]){if("string"!=typeof t[c])throw new Error("Browser version in the minVersion map should be a string: "+c+": "+String(t));return n([i,t[c]])<0}return r}var a=!0,s=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return s.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if("string"==typeof r&&r in s)return!0}return!1},s.isUnsupportedBrowser=o,s.compareVersions=n,s.check=function(e,t,r){return!o(e,t,r)},s._detect=e,s})},{}],47:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/es6.array.from"),t.exports=e("../../modules/_core").Array.from},{"../../modules/_core":76,"../../modules/es6.array.from":144,"../../modules/es6.string.iterator":156}],48:[function(e,t,r){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),t.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":142,"../modules/es6.string.iterator":156,"../modules/web.dom.iterable":162}],49:[function(e,t,r){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),t.exports=e("../modules/core.is-iterable")},{"../modules/core.is-iterable":143,"../modules/es6.string.iterator":156,"../modules/web.dom.iterable":162}],50:[function(e,t,r){var n=e("../../modules/_core"),o=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(e){return o.stringify.apply(o,arguments)}},{"../../modules/_core":76}],51:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.map"),e("../modules/es7.map.to-json"),t.exports=e("../modules/_core").Map},{"../modules/_core":76,"../modules/es6.map":146,"../modules/es6.object.to-string":153,"../modules/es6.string.iterator":156,"../modules/es7.map.to-json":158,"../modules/web.dom.iterable":162}],52:[function(e,t,r){e("../../modules/es6.object.assign"),t.exports=e("../../modules/_core").Object.assign},{"../../modules/_core":76,"../../modules/es6.object.assign":147}],53:[function(e,t,r){e("../../modules/es6.object.create");var n=e("../../modules/_core").Object;t.exports=function(e,t){return n.create(e,t)}},{"../../modules/_core":76,"../../modules/es6.object.create":148}],54:[function(e,t,r){e("../../modules/es6.object.define-property");var n=e("../../modules/_core").Object;t.exports=function(e,t,r){return n.defineProperty(e,t,r)}},{"../../modules/_core":76,"../../modules/es6.object.define-property":149}],55:[function(e,t,r){e("../../modules/es6.object.get-prototype-of"),t.exports=e("../../modules/_core").Object.getPrototypeOf},{"../../modules/_core":76,"../../modules/es6.object.get-prototype-of":150}],56:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/_core").Object.keys},{"../../modules/_core":76,"../../modules/es6.object.keys":151}],57:[function(e,t,r){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/_core").Object.setPrototypeOf},{"../../modules/_core":76,"../../modules/es6.object.set-prototype-of":152}],58:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.promise"),t.exports=e("../modules/_core").Promise},{"../modules/_core":76,"../modules/es6.object.to-string":153,"../modules/es6.promise":154,"../modules/es6.string.iterator":156,"../modules/web.dom.iterable":162}],59:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.set"),e("../modules/es7.set.to-json"),t.exports=e("../modules/_core").Set},{"../modules/_core":76,"../modules/es6.object.to-string":153,"../modules/es6.set":155,"../modules/es6.string.iterator":156,"../modules/es7.set.to-json":159,"../modules/web.dom.iterable":162}],60:[function(e,t,r){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),e("../../modules/es7.symbol.async-iterator"),e("../../modules/es7.symbol.observable"),t.exports=e("../../modules/_core").Symbol},{"../../modules/_core":76,"../../modules/es6.object.to-string":153,"../../modules/es6.symbol":157,"../../modules/es7.symbol.async-iterator":160,"../../modules/es7.symbol.observable":161}],61:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),t.exports=e("../../modules/_wks-ext").f("iterator")},{"../../modules/_wks-ext":139,"../../modules/es6.string.iterator":156,"../../modules/web.dom.iterable":162}],62:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],63:[function(e,t,r){t.exports=function(){}},{}],64:[function(e,t,r){t.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},{}],65:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":96}],66:[function(e,t,r){var n=e("./_for-of");t.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},{"./_for-of":86}],67:[function(e,t,r){var n=e("./_to-iobject"),o=e("./_to-length"),a=e("./_to-index");t.exports=function(e){return function(t,r,s){var i,c=n(t),u=o(c.length),l=a(s,u);if(e&&r!=r){for(;u>l;)if((i=c[l++])!=i)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},{"./_to-index":131,"./_to-iobject":133,"./_to-length":134}],68:[function(e,t,r){var n=e("./_ctx"),o=e("./_iobject"),a=e("./_to-object"),s=e("./_to-length"),i=e("./_array-species-create");t.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,d=6==e,f=5==e||d,p=t||i;return function(t,i,m){for(var h,_,v=a(t),b=o(v),y=n(i,m,3),g=s(b.length),k=0,w=r?p(t,g):c?p(t,0):void 0;g>k;k++)if((f||k in b)&&(h=b[k],_=y(h,k,v),e))if(r)w[k]=_;else if(_)switch(e){case 3:return!0;case 5:return h;case 6:return k;case 2:w.push(h)}else if(l)return!1;return d?-1:u||l?l:w}}},{"./_array-species-create":70,"./_ctx":78,"./_iobject":93,"./_to-length":134,"./_to-object":135}],69:[function(e,t,r){var n=e("./_is-object"),o=e("./_is-array"),a=e("./_wks")("species");t.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),n(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},{"./_is-array":95,"./_is-object":96,"./_wks":140}],70:[function(e,t,r){var n=e("./_array-species-constructor");t.exports=function(e,t){return new(n(e))(t)}},{"./_array-species-constructor":69}],71:[function(e,t,r){var n=e("./_cof"),o=e("./_wks")("toStringTag"),a="Arguments"==n(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(e){}};t.exports=function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=s(t=Object(e),o))?r:a?n(t):"Object"==(i=n(t))&&"function"==typeof t.callee?"Arguments":i}},{"./_cof":72,"./_wks":140}],72:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],73:[function(e,t,r){"use strict";var n=e("./_object-dp").f,o=e("./_object-create"),a=e("./_redefine-all"),s=e("./_ctx"),i=e("./_an-instance"),c=e("./_defined"),u=e("./_for-of"),l=e("./_iter-define"),d=e("./_iter-step"),f=e("./_set-species"),p=e("./_descriptors"),m=e("./_meta").fastKey,h=p?"_s":"size",_=function(e,t){var r,n=m(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};t.exports={getConstructor:function(e,t,r,l){var d=e(function(e,n){i(e,d,t,"_i"),e._i=o(null),e._f=void 0,e._l=void 0,e[h]=0,void 0!=n&&u(n,r,e[l],e)});return a(d.prototype,{clear:function(){for(var e=this,t=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete t[r.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var t=this,r=_(t,e);if(r){var n=r.n,o=r.p;delete t._i[r.i],r.r=!0,o&&(o.n=n),n&&(n.p=o),t._f==r&&(t._f=n),t._l==r&&(t._l=o),t[h]--}return!!r},forEach:function(e){i(this,d,"forEach");for(var t,r=s(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(r(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!_(this,e)}}),p&&n(d.prototype,"size",{get:function(){return c(this[h])}}),d},def:function(e,t,r){var n,o,a=_(e,t);return a?a.v=r:(e._l=a={i:o=m(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=a),n&&(n.n=a),e[h]++,"F"!==o&&(e._i[o]=a)),e},getEntry:_,setStrong:function(e,t,r){l(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?d(0,r.k):"values"==t?d(0,r.v):d(0,[r.k,r.v]):(e._t=void 0,d(1))},r?"entries":"values",!r,!0),f(t)}}},{"./_an-instance":64,"./_ctx":78,"./_defined":79,"./_descriptors":80,"./_for-of":86,"./_iter-define":99,"./_iter-step":101,"./_meta":105,"./_object-create":108,"./_object-dp":109,"./_redefine-all":121,"./_set-species":124}],74:[function(e,t,r){var n=e("./_classof"),o=e("./_array-from-iterable");t.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return o(this)}}},{"./_array-from-iterable":66,"./_classof":71}],75:[function(e,t,r){"use strict";var n=e("./_global"),o=e("./_export"),a=e("./_meta"),s=e("./_fails"),i=e("./_hide"),c=e("./_redefine-all"),u=e("./_for-of"),l=e("./_an-instance"),d=e("./_is-object"),f=e("./_set-to-string-tag"),p=e("./_object-dp").f,m=e("./_array-methods")(0),h=e("./_descriptors");t.exports=function(e,t,r,_,v,b){var y=n[e],g=y,k=v?"set":"add",w=g&&g.prototype,P={};return h&&"function"==typeof g&&(b||w.forEach&&!s(function(){(new g).entries().next()}))?(g=t(function(t,r){l(t,g,e,"_c"),t._c=new y,void 0!=r&&u(r,v,t[k],t)}),m("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in w&&(!b||"clear"!=e)&&i(g.prototype,e,function(r,n){if(l(this,g,e),!t&&b&&!d(r))return"get"==e&&void 0;var o=this._c[e](0===r?0:r,n);return t?this:o})}),"size"in w&&p(g.prototype,"size",{get:function(){return this._c.size}})):(g=_.getConstructor(t,e,v,k),c(g.prototype,r),a.NEED=!0),f(g,e),P[e]=g,o(o.G+o.W+o.F,P),b||_.setStrong(g,e,v),g}},{"./_an-instance":64,"./_array-methods":68,"./_descriptors":80,"./_export":84,"./_fails":85,"./_for-of":86,"./_global":87,"./_hide":89,"./_is-object":96,"./_meta":105,"./_object-dp":109,"./_redefine-all":121,"./_set-to-string-tag":125}],76:[function(e,t,r){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},{}],77:[function(e,t,r){"use strict";var n=e("./_object-dp"),o=e("./_property-desc");t.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},{"./_object-dp":109,"./_property-desc":120}],78:[function(e,t,r){var n=e("./_a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":62}],79:[function(e,t,r){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],80:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":85}],81:[function(e,t,r){var n=e("./_is-object"),o=e("./_global").document,a=n(o)&&n(o.createElement);t.exports=function(e){return a?o.createElement(e):{}}},{"./_global":87,"./_is-object":96}],82:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],83:[function(e,t,r){var n=e("./_object-keys"),o=e("./_object-gops"),a=e("./_object-pie");t.exports=function(e){var t=n(e),r=o.f;if(r)for(var s,i=r(e),c=a.f,u=0;i.length>u;)c.call(e,s=i[u++])&&t.push(s);return t}},{"./_object-gops":114,"./_object-keys":117,"./_object-pie":118}],84:[function(e,t,r){var n=e("./_global"),o=e("./_core"),a=e("./_ctx"),s=e("./_hide"),i=function(e,t,r){var c,u,l,d=e&i.F,f=e&i.G,p=e&i.S,m=e&i.P,h=e&i.B,_=e&i.W,v=f?o:o[t]||(o[t]={}),b=v.prototype,y=f?n:p?n[t]:(n[t]||{}).prototype;f&&(r=t);for(c in r)(u=!d&&y&&void 0!==y[c])&&c in v||(l=u?y[c]:r[c],v[c]=f&&"function"!=typeof y[c]?r[c]:h&&u?a(l,n):_&&y[c]==l?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):m&&"function"==typeof l?a(Function.call,l):l,m&&((v.virtual||(v.virtual={}))[c]=l,e&i.R&&b&&!b[c]&&s(b,c,l)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,t.exports=i},{"./_core":76,"./_ctx":78,"./_global":87,"./_hide":89}],85:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],86:[function(e,t,r){var n=e("./_ctx"),o=e("./_iter-call"),a=e("./_is-array-iter"),s=e("./_an-object"),i=e("./_to-length"),c=e("./core.get-iterator-method"),u={},l={};(r=t.exports=function(e,t,r,d,f){var p,m,h,_,v=f?function(){return e}:c(e),b=n(r,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(p=i(e.length);p>y;y++)if((_=t?b(s(m=e[y])[0],m[1]):b(e[y]))===u||_===l)return _}else for(h=v.call(e);!(m=h.next()).done;)if((_=o(h,b,m.value,t))===u||_===l)return _}).BREAK=u,r.RETURN=l},{"./_an-object":65,"./_ctx":78,"./_is-array-iter":94,"./_iter-call":97,"./_to-length":134,"./core.get-iterator-method":141}],87:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],88:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],89:[function(e,t,r){var n=e("./_object-dp"),o=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":80,"./_object-dp":109,"./_property-desc":120}],90:[function(e,t,r){t.exports=e("./_global").document&&document.documentElement},{"./_global":87}],91:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":80,"./_dom-create":81,"./_fails":85}],92:[function(e,t,r){t.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],93:[function(e,t,r){var n=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./_cof":72}],94:[function(e,t,r){var n=e("./_iterators"),o=e("./_wks")("iterator"),a=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||a[o]===e)}},{"./_iterators":102,"./_wks":140}],95:[function(e,t,r){var n=e("./_cof");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"./_cof":72}],96:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],97:[function(e,t,r){var n=e("./_an-object");t.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var a=e.return;throw void 0!==a&&n(a.call(e)),t}}},{"./_an-object":65}],98:[function(e,t,r){"use strict";var n=e("./_object-create"),o=e("./_property-desc"),a=e("./_set-to-string-tag"),s={};e("./_hide")(s,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=n(s,{next:o(1,r)}),a(e,t+" Iterator")}},{"./_hide":89,"./_object-create":108,"./_property-desc":120,"./_set-to-string-tag":125,"./_wks":140}],99:[function(e,t,r){"use strict";var n=e("./_library"),o=e("./_export"),a=e("./_redefine"),s=e("./_hide"),i=e("./_has"),c=e("./_iterators"),u=e("./_iter-create"),l=e("./_set-to-string-tag"),d=e("./_object-gpo"),f=e("./_wks")("iterator"),p=!([].keys&&"next"in[].keys()),m=function(){return this};t.exports=function(e,t,r,h,_,v,b){u(r,t,h);var y,g,k,w=function(e){if(!p&&e in x)return x[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},P=t+" Iterator",j="values"==_,C=!1,x=e.prototype,S=x[f]||x["@@iterator"]||_&&x[_],E=S||w(_),T=_?j?w("entries"):E:void 0,R="Array"==t?x.entries||S:S;if(R&&(k=d(R.call(new e)))!==Object.prototype&&(l(k,P,!0),n||i(k,f)||s(k,f,m)),j&&S&&"values"!==S.name&&(C=!0,E=function(){return S.call(this)}),n&&!b||!p&&!C&&x[f]||s(x,f,E),c[t]=E,c[P]=m,_)if(y={values:j?E:w("values"),keys:v?E:w("keys"),entries:T},b)for(g in y)g in x||a(x,g,y[g]);else o(o.P+o.F*(p||C),t,y);return y}},{"./_export":84,"./_has":88,"./_hide":89,"./_iter-create":98,"./_iterators":102,"./_library":104,"./_object-gpo":115,"./_redefine":122,"./_set-to-string-tag":125,"./_wks":140}],100:[function(e,t,r){var n=e("./_wks")("iterator"),o=!1;try{var a=[7][n]();a.return=function(){o=!0},Array.from(a,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var a=[7],s=a[n]();s.next=function(){return{done:r=!0}},a[n]=function(){return s},e(a)}catch(e){}return r}},{"./_wks":140}],101:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],102:[function(e,t,r){t.exports={}},{}],103:[function(e,t,r){var n=e("./_object-keys"),o=e("./_to-iobject");t.exports=function(e,t){for(var r,a=o(e),s=n(a),i=s.length,c=0;i>c;)if(a[r=s[c++]]===t)return r}},{"./_object-keys":117,"./_to-iobject":133}],104:[function(e,t,r){t.exports=!0},{}],105:[function(e,t,r){var n=e("./_uid")("meta"),o=e("./_is-object"),a=e("./_has"),s=e("./_object-dp").f,i=0,c=Object.isExtensible||function(){return!0},u=!e("./_fails")(function(){return c(Object.preventExtensions({}))}),l=function(e){s(e,n,{value:{i:"O"+ ++i,w:{}}})},d=t.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!a(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&d.NEED&&c(e)&&!a(e,n)&&l(e),e}}},{"./_fails":85,"./_has":88,"./_is-object":96,"./_object-dp":109,"./_uid":137}],106:[function(e,t,r){var n=e("./_global"),o=e("./_task").set,a=n.MutationObserver||n.WebKitMutationObserver,s=n.process,i=n.Promise,c="process"==e("./_cof")(s);t.exports=function(){var e,t,r,u=function(){var n,o;for(c&&(n=s.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){s.nextTick(u)};else if(a){var l=!0,d=document.createTextNode("");new a(u).observe(d,{characterData:!0}),r=function(){d.data=l=!l}}else if(i&&i.resolve){var f=i.resolve();r=function(){f.then(u)}}else r=function(){o.call(n,u)};return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},{"./_cof":72,"./_global":87,"./_task":130}],107:[function(e,t,r){"use strict";var n=e("./_object-keys"),o=e("./_object-gops"),a=e("./_object-pie"),s=e("./_to-object"),i=e("./_iobject"),c=Object.assign;t.exports=!c||e("./_fails")(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=s(e),c=arguments.length,u=1,l=o.f,d=a.f;c>u;)for(var f,p=i(arguments[u++]),m=l?n(p).concat(l(p)):n(p),h=m.length,_=0;h>_;)d.call(p,f=m[_++])&&(r[f]=p[f]);return r}:c},{"./_fails":85,"./_iobject":93,"./_object-gops":114,"./_object-keys":117,"./_object-pie":118,"./_to-object":135}],108:[function(e,t,r){var n=e("./_an-object"),o=e("./_object-dps"),a=e("./_enum-bug-keys"),s=e("./_shared-key")("IE_PROTO"),i=function(){},c=function(){var t,r=e("./_dom-create")("iframe"),n=a.length;for(r.style.display="none",e("./_html").appendChild(r),r.src="javascript:",(t=r.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;n--;)delete c.prototype[a[n]];return c()};t.exports=Object.create||function(e,t){var r;return null!==e?(i.prototype=n(e),r=new i,i.prototype=null,r[s]=e):r=c(),void 0===t?r:o(r,t)}},{"./_an-object":65,"./_dom-create":81,"./_enum-bug-keys":82,"./_html":90,"./_object-dps":110,"./_shared-key":126}],109:[function(e,t,r){var n=e("./_an-object"),o=e("./_ie8-dom-define"),a=e("./_to-primitive"),s=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=a(t,!0),n(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":65,"./_descriptors":80,"./_ie8-dom-define":91,"./_to-primitive":136}],110:[function(e,t,r){var n=e("./_object-dp"),o=e("./_an-object"),a=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){o(e);for(var r,s=a(t),i=s.length,c=0;i>c;)n.f(e,r=s[c++],t[r]);return e}},{"./_an-object":65,"./_descriptors":80,"./_object-dp":109,"./_object-keys":117}],111:[function(e,t,r){var n=e("./_object-pie"),o=e("./_property-desc"),a=e("./_to-iobject"),s=e("./_to-primitive"),i=e("./_has"),c=e("./_ie8-dom-define"),u=Object.getOwnPropertyDescriptor;r.f=e("./_descriptors")?u:function(e,t){if(e=a(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(i(e,t))return o(!n.f.call(e,t),e[t])}},{"./_descriptors":80,"./_has":88,"./_ie8-dom-define":91,"./_object-pie":118,"./_property-desc":120,"./_to-iobject":133,"./_to-primitive":136}],112:[function(e,t,r){var n=e("./_to-iobject"),o=e("./_object-gopn").f,a={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(e){try{return o(e)}catch(e){return s.slice()}};t.exports.f=function(e){return s&&"[object Window]"==a.call(e)?i(e):o(n(e))}},{"./_object-gopn":113,"./_to-iobject":133}],113:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},{"./_enum-bug-keys":82,"./_object-keys-internal":116}],114:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],115:[function(e,t,r){var n=e("./_has"),o=e("./_to-object"),a=e("./_shared-key")("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},{"./_has":88,"./_shared-key":126,"./_to-object":135}],116:[function(e,t,r){var n=e("./_has"),o=e("./_to-iobject"),a=e("./_array-includes")(!1),s=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var r,i=o(e),c=0,u=[];for(r in i)r!=s&&n(i,r)&&u.push(r);for(;t.length>c;)n(i,r=t[c++])&&(~a(u,r)||u.push(r));return u}},{"./_array-includes":67,"./_has":88,"./_shared-key":126,"./_to-iobject":133}],117:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return n(e,o)}},{"./_enum-bug-keys":82,"./_object-keys-internal":116}],118:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],119:[function(e,t,r){var n=e("./_export"),o=e("./_core"),a=e("./_fails");t.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*a(function(){r(1)}),"Object",s)}},{"./_core":76,"./_export":84,"./_fails":85}],120:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],121:[function(e,t,r){var n=e("./_hide");t.exports=function(e,t,r){for(var o in t)r&&e[o]?e[o]=t[o]:n(e,o,t[o]);return e}},{"./_hide":89}],122:[function(e,t,r){t.exports=e("./_hide")},{"./_hide":89}],123:[function(e,t,r){var n=e("./_is-object"),o=e("./_an-object"),a=function(e,t){if(o(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{(n=e("./_ctx")(Function.call,e("./_object-gopd").f(Object.prototype,"__proto__").set,2))(t,[]),r=!(t instanceof Array)}catch(e){r=!0}return function(e,t){return a(e,t),r?e.__proto__=t:n(e,t),e}}({},!1):void 0),check:a}},{"./_an-object":65,"./_ctx":78,"./_is-object":96,"./_object-gopd":111}],124:[function(e,t,r){"use strict";var n=e("./_global"),o=e("./_core"),a=e("./_object-dp"),s=e("./_descriptors"),i=e("./_wks")("species");t.exports=function(e){var t="function"==typeof o[e]?o[e]:n[e];s&&t&&!t[i]&&a.f(t,i,{configurable:!0,get:function(){return this}})}},{"./_core":76,"./_descriptors":80,"./_global":87,"./_object-dp":109,"./_wks":140}],125:[function(e,t,r){var n=e("./_object-dp").f,o=e("./_has"),a=e("./_wks")("toStringTag");t.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},{"./_has":88,"./_object-dp":109,"./_wks":140}],126:[function(e,t,r){var n=e("./_shared")("keys"),o=e("./_uid");t.exports=function(e){return n[e]||(n[e]=o(e))}},{"./_shared":127,"./_uid":137}],127:[function(e,t,r){var n=e("./_global"),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(e){return o[e]||(o[e]={})}},{"./_global":87}],128:[function(e,t,r){var n=e("./_an-object"),o=e("./_a-function"),a=e("./_wks")("species");t.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||void 0==(r=n(s)[a])?t:o(r)}},{"./_a-function":62,"./_an-object":65,"./_wks":140}],129:[function(e,t,r){var n=e("./_to-integer"),o=e("./_defined");t.exports=function(e){return function(t,r){var a,s,i=String(o(t)),c=n(r),u=i.length;return c<0||c>=u?e?"":void 0:(a=i.charCodeAt(c))<55296||a>56319||c+1===u||(s=i.charCodeAt(c+1))<56320||s>57343?e?i.charAt(c):a:e?i.slice(c,c+2):s-56320+(a-55296<<10)+65536}}},{"./_defined":79,"./_to-integer":132}],130:[function(e,t,r){var n,o,a,s=e("./_ctx"),i=e("./_invoke"),c=e("./_html"),u=e("./_dom-create"),l=e("./_global"),d=l.process,f=l.setImmediate,p=l.clearImmediate,m=l.MessageChannel,h=0,_={},v=function(){var e=+this;if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},b=function(e){v.call(e.data)};f&&p||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return _[++h]=function(){i("function"==typeof e?e:Function(e),t)},n(h),h},p=function(e){delete _[e]},"process"==e("./_cof")(d)?n=function(e){d.nextTick(s(v,e,1))}:m?(a=(o=new m).port2,o.port1.onmessage=b,n=s(a.postMessage,a,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),v.call(e)}}:function(e){setTimeout(s(v,e,1),0)}),t.exports={set:f,clear:p}},{"./_cof":72,"./_ctx":78,"./_dom-create":81,"./_global":87,"./_html":90,"./_invoke":92}],131:[function(e,t,r){var n=e("./_to-integer"),o=Math.max,a=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):a(e,t)}},{"./_to-integer":132}],132:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],133:[function(e,t,r){var n=e("./_iobject"),o=e("./_defined");t.exports=function(e){return n(o(e))}},{"./_defined":79,"./_iobject":93}],134:[function(e,t,r){var n=e("./_to-integer"),o=Math.min;t.exports=function(e){return e>0?o(n(e),9007199254740991):0}},{"./_to-integer":132}],135:[function(e,t,r){var n=e("./_defined");t.exports=function(e){return Object(n(e))}},{"./_defined":79}],136:[function(e,t,r){var n=e("./_is-object");t.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":96}],137:[function(e,t,r){var n=0,o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},{}],138:[function(e,t,r){var n=e("./_global"),o=e("./_core"),a=e("./_library"),s=e("./_wks-ext"),i=e("./_object-dp").f;t.exports=function(e){var t=o.Symbol||(o.Symbol=a?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||i(t,e,{value:s.f(e)})}},{"./_core":76,"./_global":87,"./_library":104,"./_object-dp":109,"./_wks-ext":139}],139:[function(e,t,r){r.f=e("./_wks")},{"./_wks":140}],140:[function(e,t,r){var n=e("./_shared")("wks"),o=e("./_uid"),a=e("./_global").Symbol,s="function"==typeof a;(t.exports=function(e){return n[e]||(n[e]=s&&a[e]||(s?a:o)("Symbol."+e))}).store=n},{"./_global":87,"./_shared":127,"./_uid":137}],141:[function(e,t,r){var n=e("./_classof"),o=e("./_wks")("iterator"),a=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||a[n(e)]}},{"./_classof":71,"./_core":76,"./_iterators":102,"./_wks":140}],142:[function(e,t,r){var n=e("./_an-object"),o=e("./core.get-iterator-method");t.exports=e("./_core").getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},{"./_an-object":65,"./_core":76,"./core.get-iterator-method":141}],143:[function(e,t,r){var n=e("./_classof"),o=e("./_wks")("iterator"),a=e("./_iterators");t.exports=e("./_core").isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||a.hasOwnProperty(n(t))}},{"./_classof":71,"./_core":76,"./_iterators":102,"./_wks":140}],144:[function(e,t,r){"use strict";var n=e("./_ctx"),o=e("./_export"),a=e("./_to-object"),s=e("./_iter-call"),i=e("./_is-array-iter"),c=e("./_to-length"),u=e("./_create-property"),l=e("./core.get-iterator-method");o(o.S+o.F*!e("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,o,d,f=a(e),p="function"==typeof this?this:Array,m=arguments.length,h=m>1?arguments[1]:void 0,_=void 0!==h,v=0,b=l(f);if(_&&(h=n(h,m>2?arguments[2]:void 0,2)),void 0==b||p==Array&&i(b))for(r=new p(t=c(f.length));t>v;v++)u(r,v,_?h(f[v],v):f[v]);else for(d=b.call(f),r=new p;!(o=d.next()).done;v++)u(r,v,_?s(d,h,[o.value,v],!0):o.value);return r.length=v,r}})},{"./_create-property":77,"./_ctx":78,"./_export":84,"./_is-array-iter":94,"./_iter-call":97,"./_iter-detect":100,"./_to-length":134,"./_to-object":135,"./core.get-iterator-method":141}],145:[function(e,t,r){"use strict";var n=e("./_add-to-unscopables"),o=e("./_iter-step"),a=e("./_iterators"),s=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]])},"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},{"./_add-to-unscopables":63,"./_iter-define":99,"./_iter-step":101,"./_iterators":102,"./_to-iobject":133}],146:[function(e,t,r){"use strict";var n=e("./_collection-strong");t.exports=e("./_collection")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(this,e);return t&&t.v},set:function(e,t){return n.def(this,0===e?0:e,t)}},n,!0)},{"./_collection":75,"./_collection-strong":73}],147:[function(e,t,r){var n=e("./_export");n(n.S+n.F,"Object",{assign:e("./_object-assign")})},{"./_export":84,"./_object-assign":107}],148:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{create:e("./_object-create")})},{"./_export":84,"./_object-create":108}],149:[function(e,t,r){var n=e("./_export");n(n.S+n.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":80,"./_export":84,"./_object-dp":109}],150:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-gpo");e("./_object-sap")("getPrototypeOf",function(){return function(e){return o(n(e))}})},{"./_object-gpo":115,"./_object-sap":119,"./_to-object":135}],151:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return o(n(e))}})},{"./_object-keys":117,"./_object-sap":119,"./_to-object":135}],152:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{setPrototypeOf:e("./_set-proto").set})},{"./_export":84,"./_set-proto":123}],153:[function(e,t,r){},{}],154:[function(e,t,r){"use strict";var n,o,a,s=e("./_library"),i=e("./_global"),c=e("./_ctx"),u=e("./_classof"),l=e("./_export"),d=e("./_is-object"),f=e("./_a-function"),p=e("./_an-instance"),m=e("./_for-of"),h=e("./_species-constructor"),_=e("./_task").set,v=e("./_microtask")(),b=i.TypeError,y=i.process,g=i.Promise,k="process"==u(y=i.process),w=function(){},P=!!function(){try{var t=g.resolve(1),r=(t.constructor={})[e("./_wks")("species")]=function(e){e(w,w)};return(k||"function"==typeof PromiseRejectionEvent)&&t.then(w)instanceof r}catch(e){}}(),j=function(e,t){return e===t||e===g&&t===a},C=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},x=function(e){return j(g,e)?new S(e):new o(e)},S=o=function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw b("Bad Promise constructor");t=e,r=n}),this.resolve=f(t),this.reject=f(r)},E=function(e){try{e()}catch(e){return{error:e}}},T=function(e,t){if(!e._n){e._n=!0;var r=e._c;v(function(){for(var n=e._v,o=1==e._s,a=0;r.length>a;)!function(t){var r,a,s=o?t.ok:t.fail,i=t.resolve,c=t.reject,u=t.domain;try{s?(o||(2==e._h&&O(e),e._h=1),!0===s?r=n:(u&&u.enter(),r=s(n),u&&u.exit()),r===t.promise?c(b("Promise-chain cycle")):(a=C(r))?a.call(r,i,c):i(r)):c(n)}catch(e){c(e)}}(r[a++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){_.call(i,function(){var t,r,n,o=e._v;if(I(e)&&(t=E(function(){k?y.emit("unhandledRejection",o,e):(r=i.onunhandledrejection)?r({promise:e,reason:o}):(n=i.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=k||I(e)?2:1),e._a=void 0,t)throw t.error})},I=function(e){if(1==e._h)return!1;for(var t,r=e._a||e._c,n=0;r.length>n;)if((t=r[n++]).fail||!I(t.promise))return!1;return!0},O=function(e){_.call(i,function(){var t;k?y.emit("rejectionHandled",e):(t=i.onrejectionhandled)&&t({promise:e,reason:e._v})})},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),T(t,!0))},D=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw b("Promise can't be resolved itself");(t=C(e))?v(function(){var n={_w:r,_d:!1};try{t.call(e,c(D,n,1),c(F,n,1))}catch(e){F.call(n,e)}}):(r._v=e,r._s=1,T(r,!1))}catch(e){F.call({_w:r,_d:!1},e)}}};P||(g=function(e){p(this,g,"Promise","_h"),f(e),n.call(this);try{e(c(D,this,1),c(F,this,1))}catch(e){F.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=e("./_redefine-all")(g.prototype,{then:function(e,t){var r=x(h(this,g));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=k?y.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&T(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),S=function(){var e=new n;this.promise=e,this.resolve=c(D,e,1),this.reject=c(F,e,1)}),l(l.G+l.W+l.F*!P,{Promise:g}),e("./_set-to-string-tag")(g,"Promise"),e("./_set-species")("Promise"),a=e("./_core").Promise,l(l.S+l.F*!P,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(s||!P),"Promise",{resolve:function(e){if(e instanceof g&&j(e.constructor,this))return e;var t=x(this);return(0,t.resolve)(e),t.promise}}),l(l.S+l.F*!(P&&e("./_iter-detect")(function(e){g.all(e).catch(w)})),"Promise",{all:function(e){var t=this,r=x(t),n=r.resolve,o=r.reject,a=E(function(){var r=[],a=0,s=1;m(e,!1,function(e){var i=a++,c=!1;r.push(void 0),s++,t.resolve(e).then(function(e){c||(c=!0,r[i]=e,--s||n(r))},o)}),--s||n(r)});return a&&o(a.error),r.promise},race:function(e){var t=this,r=x(t),n=r.reject,o=E(function(){m(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o&&n(o.error),r.promise}})},{"./_a-function":62,"./_an-instance":64,"./_classof":71,"./_core":76,"./_ctx":78,"./_export":84,"./_for-of":86,"./_global":87,"./_is-object":96,"./_iter-detect":100,"./_library":104,"./_microtask":106,"./_redefine-all":121,"./_set-species":124,"./_set-to-string-tag":125,"./_species-constructor":128,"./_task":130,"./_wks":140}],155:[function(e,t,r){"use strict";var n=e("./_collection-strong");t.exports=e("./_collection")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(this,e=0===e?0:e,e)}},n)},{"./_collection":75,"./_collection-strong":73}],156:[function(e,t,r){"use strict";var n=e("./_string-at")(!0);e("./_iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},{"./_iter-define":99,"./_string-at":129}],157:[function(e,t,r){"use strict";var n=e("./_global"),o=e("./_has"),a=e("./_descriptors"),s=e("./_export"),i=e("./_redefine"),c=e("./_meta").KEY,u=e("./_fails"),l=e("./_shared"),d=e("./_set-to-string-tag"),f=e("./_uid"),p=e("./_wks"),m=e("./_wks-ext"),h=e("./_wks-define"),_=e("./_keyof"),v=e("./_enum-keys"),b=e("./_is-array"),y=e("./_an-object"),g=e("./_to-iobject"),k=e("./_to-primitive"),w=e("./_property-desc"),P=e("./_object-create"),j=e("./_object-gopn-ext"),C=e("./_object-gopd"),x=e("./_object-dp"),S=e("./_object-keys"),E=C.f,T=x.f,R=j.f,I=n.Symbol,O=n.JSON,F=O&&O.stringify,D=p("_hidden"),M=p("toPrimitive"),L={}.propertyIsEnumerable,A=l("symbol-registry"),N=l("symbols"),B=l("op-symbols"),U=Object.prototype,G="function"==typeof I,z=n.QObject,q=!z||!z.prototype||!z.prototype.findChild,K=a&&u(function(){return 7!=P(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=E(U,t);n&&delete U[t],T(e,t,r),n&&e!==U&&T(U,t,n)}:T,W=function(e){var t=N[e]=P(I.prototype);return t._k=e,t},V=G&&"symbol"==typeof I.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof I},J=function(e,t,r){return e===U&&J(B,t,r),y(e),t=k(t,!0),y(r),o(N,t)?(r.enumerable?(o(e,D)&&e[D][t]&&(e[D][t]=!1),r=P(r,{enumerable:w(0,!1)})):(o(e,D)||T(e,D,w(1,{})),e[D][t]=!0),K(e,t,r)):T(e,t,r)},Q=function(e,t){y(e);for(var r,n=v(t=g(t)),o=0,a=n.length;a>o;)J(e,r=n[o++],t[r]);return e},$=function(e){var t=L.call(this,e=k(e,!0));return!(this===U&&o(N,e)&&!o(B,e))&&(!(t||!o(this,e)||!o(N,e)||o(this,D)&&this[D][e])||t)},H=function(e,t){if(e=g(e),t=k(t,!0),e!==U||!o(N,t)||o(B,t)){var r=E(e,t);return!r||!o(N,t)||o(e,D)&&e[D][t]||(r.enumerable=!0),r}},X=function(e){for(var t,r=R(g(e)),n=[],a=0;r.length>a;)o(N,t=r[a++])||t==D||t==c||n.push(t);return n},Z=function(e){for(var t,r=e===U,n=R(r?B:g(e)),a=[],s=0;n.length>s;)!o(N,t=n[s++])||r&&!o(U,t)||a.push(N[t]);return a};G||(i((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(r){this===U&&t.call(B,r),o(this,D)&&o(this[D],e)&&(this[D][e]=!1),K(this,e,w(1,r))};return a&&q&&K(U,e,{configurable:!0,set:t}),W(e)}).prototype,"toString",function(){return this._k}),C.f=H,x.f=J,e("./_object-gopn").f=j.f=X,e("./_object-pie").f=$,e("./_object-gops").f=Z,a&&!e("./_library")&&i(U,"propertyIsEnumerable",$,!0),m.f=function(e){return W(p(e))}),s(s.G+s.W+s.F*!G,{Symbol:I});for(var Y="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Y.length>ee;)p(Y[ee++]);for(var Y=S(p.store),ee=0;Y.length>ee;)h(Y[ee++]);s(s.S+s.F*!G,"Symbol",{for:function(e){return o(A,e+="")?A[e]:A[e]=I(e)},keyFor:function(e){if(V(e))return _(A,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!G,"Object",{create:function(e,t){return void 0===t?P(e):Q(P(e),t)},defineProperty:J,defineProperties:Q,getOwnPropertyDescriptor:H,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),O&&s(s.S+s.F*(!G||u(function(){var e=I();return"[null]"!=F([e])||"{}"!=F({a:e})||"{}"!=F(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!V(e)){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);return"function"==typeof(t=n[1])&&(r=t),!r&&b(t)||(t=function(e,t){if(r&&(t=r.call(this,e,t)),!V(t))return t}),n[1]=t,F.apply(O,n)}}}),I.prototype[M]||e("./_hide")(I.prototype,M,I.prototype.valueOf),d(I,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},{"./_an-object":65,"./_descriptors":80,"./_enum-keys":83,"./_export":84,"./_fails":85,"./_global":87,"./_has":88,"./_hide":89,"./_is-array":95,"./_keyof":103,"./_library":104,"./_meta":105,"./_object-create":108,"./_object-dp":109,"./_object-gopd":111,"./_object-gopn":113,"./_object-gopn-ext":112,"./_object-gops":114,"./_object-keys":117,"./_object-pie":118,"./_property-desc":120,"./_redefine":122,"./_set-to-string-tag":125,"./_shared":127,"./_to-iobject":133,"./_to-primitive":136,"./_uid":137,"./_wks":140,"./_wks-define":138,"./_wks-ext":139}],158:[function(e,t,r){var n=e("./_export");n(n.P+n.R,"Map",{toJSON:e("./_collection-to-json")("Map")})},{"./_collection-to-json":74,"./_export":84}],159:[function(e,t,r){var n=e("./_export");n(n.P+n.R,"Set",{toJSON:e("./_collection-to-json")("Set")})},{"./_collection-to-json":74,"./_export":84}],160:[function(e,t,r){e("./_wks-define")("asyncIterator")},{"./_wks-define":138}],161:[function(e,t,r){e("./_wks-define")("observable")},{"./_wks-define":138}],162:[function(e,t,r){e("./es6.array.iterator");for(var n=e("./_global"),o=e("./_hide"),a=e("./_iterators"),s=e("./_wks")("toStringTag"),i=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var u=i[c],l=n[u],d=l&&l.prototype;d&&!d[s]&&o(d,s,u),a[u]=a.Array}},{"./_global":87,"./_hide":89,"./_iterators":102,"./_wks":140,"./es6.array.iterator":145}],163:[function(e,t,r){(function(n){function o(){var e;try{e=r.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(r=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},r.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff),t){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))}),e.splice(a,0,n)}},r.save=function(e){try{null==e?r.storage.removeItem("debug"):r.storage.debug=e}catch(e){}},r.load=o,r.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},r.enable(o())}).call(this,e("_process"))},{"./debug":164,_process:167}],164:[function(e,t,r){function n(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return r.colors[Math.abs(n)%r.colors.length]}function o(e){function t(){if(t.enabled){var e=t,n=+new Date,a=n-(o||n);e.diff=a,e.prev=o,e.curr=n,o=n;for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];s[0]=r.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;c++;var o=r.formatters[n];if("function"==typeof o){var a=s[c];t=o.call(e,a),s.splice(c,1),c--}return t}),r.formatArgs.call(e,s),(t.log||r.log||console.log.bind(console)).apply(e,s)}}var o;return t.namespace=e,t.enabled=r.enabled(e),t.useColors=r.useColors(),t.color=n(e),t.destroy=a,"function"==typeof r.init&&r.init(t),r.instances.push(t),t}function a(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}(r=t.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){r.save(e),r.names=[],r.skips=[];var t,n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){var a=r.instances[t];a.enabled=r.enabled(a.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.instances=[],r.names=[],r.skips=[],r.formatters={}},{ms:166}],165:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function a(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],i(r))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(s(r))for(a=Array.prototype.slice.call(arguments,1),n=(u=r.slice()).length,c=0;c<n;c++)u[c].apply(this,a);return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(r=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,a,i;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],a=r.length,n=-1,r===t||o(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(r)){for(i=a;i-- >0;)if(r[i]===t||r[i].listener&&r[i].listener===t){n=i;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],o(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],166:[function(e,t,r){function n(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*d;case"days":case"day":case"d":return r*l;case"hours":case"hour":case"hrs":case"hr":case"h":return r*u;case"minutes":case"minute":case"mins":case"min":case"m":return r*c;case"seconds":case"second":case"secs":case"sec":case"s":return r*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function o(e){return e>=l?Math.round(e/l)+"d":e>=u?Math.round(e/u)+"h":e>=c?Math.round(e/c)+"m":e>=i?Math.round(e/i)+"s":e+"ms"}function a(e){return s(e,l,"day")||s(e,u,"hour")||s(e,c,"minute")||s(e,i,"second")||e+" ms"}function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var i=1e3,c=60*i,u=60*c,l=24*u,d=365.25*l;t.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return n(e);if("number"===r&&!1===isNaN(e))return t.long?a(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],167:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(d===setTimeout)return setTimeout(e,0);if((d===n||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function s(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function i(){_&&m&&(_=!1,m.length?h=m.concat(h):v=-1,h.length&&c())}function c(){if(!_){var e=a(i);_=!0;for(var t=h.length;t;){for(m=h,h=[];++v<t;)m&&m[v].run();v=-1,t=h.length}m=null,_=!1,s(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var d,f,p=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:n}catch(e){d=n}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var m,h=[],_=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new u(e,t)),1!==h.length||_||a(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],168:[function(e,t,r){!function(e){function r(e){var t=(e=e||{}).min,r=e.max,n=e.integer||!1;if(null==t&&null==r?(t=0,r=1):null==t?t=r-1:null==r&&(r=t+1),r<t)throw new Error("invalid options, max must be >= min");return{min:t,max:r,integer:n}}function n(e){if((e=r(e)).max===e.min)return e.min;var t=Math.random()*(e.max-e.min+Number(!!e.integer))+e.min;return e.integer?Math.floor(t):t}t.exports=n,t.exports.generator=function(e){return e=r(e),function(t,r,o){return e.min=null!=t?t:e.min,e.max=null!=r?r:e.max,e.integer=null!=o?o:e.integer,n(e)}},t.exports.defaults=r}()},{}],169:[function(e,t,r){var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},{}],170:[function(e,t,r){var n=e("./parser"),o=e("./writer");r.write=o,r.parse=n.parse,r.parseFmtpConfig=n.parseFmtpConfig,r.parseParams=n.parseParams,r.parsePayloads=n.parsePayloads,r.parseRemoteCandidates=n.parseRemoteCandidates,r.parseImageAttributes=n.parseImageAttributes,r.parseSimulcastStreamList=n.parseSimulcastStreamList},{"./parser":171,"./writer":172}],171:[function(e,t,r){var n=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,r,o){if(o&&!r)t[o]=n(e[1]);else for(var a=0;a<r.length;a+=1)null!=e[a+1]&&(t[r[a]]=n(e[a+1]))},a=function(e,t,r){var n=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:n&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:n?t[e.name]:t;o(r.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},s=e("./grammar"),i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],o=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var i=0;i<(s[t]||[]).length;i+=1){var c=s[t][i];if(c.reg.test(o))return a(c,n,o)}}),t.media=r,t};var c=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length&&(e[r[0]]=n(r[1])),e};r.parseParams=function(e){return e.split(/\;\s?/).reduce(c,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(e){return e.split(" ").map(Number)},r.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),o=0;o<r.length;o+=3)t.push({component:r[o],ip:r[o+1],port:r[o+2]});return t},r.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(c,{})})},r.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}})})}},{"./grammar":169}],172:[function(e,t,r){var n=e("./grammar"),o=/%[sdv%]/g,a=function(e){var t=1,r=arguments,n=r.length;return e.replace(o,function(e){if(t>=n)return e;var o=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},s=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?n.push(r[t.name][s]):n.push(r[t.names[o]])}else n.push(r[t.name]);return a.apply(null,n)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||i,o=t.innerOrder||c,a=[];return r.forEach(function(t){n[t].forEach(function(r){r.name in e&&null!=e[r.name]?a.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){a.push(s(t,r,e))})})}),e.media.forEach(function(e){a.push(s("m",n.m[0],e)),o.forEach(function(t){n[t].forEach(function(r){r.name in e&&null!=e[r.name]?a.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){a.push(s(t,r,e))})})})}),a.join("\r\n")+"\r\n"}},{"./grammar":169}]},{},[21])(21)});